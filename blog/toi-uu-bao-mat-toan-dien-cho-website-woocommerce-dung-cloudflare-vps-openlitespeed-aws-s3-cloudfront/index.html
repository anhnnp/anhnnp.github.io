<!DOCTYPE html><html lang="en" class="h-full"> <head><link as="font" crossorigin rel="preload" href="/fonts/outfit.ttf" type="font/ttf"><style>@font-face {font-style: normal;font-family: Outfit;font-display: swap;src: url(/fonts/outfit.ttf)}</style><style>@font-face {font-style: normal;font-family: Poppins;font-display: swap;src: url(/fonts/poppins.ttf)}</style><style>@font-face {font-style: normal;font-family: Righteous;font-display: swap;src: url(/fonts/righteous.ttf)}</style><style>@font-face {font-style: normal;font-family: Sanchez;font-display: swap;src: url(/fonts/sanchez.ttf)}</style><style>@font-face {font-style: normal;font-family: DM Serif Text;font-display: swap;src: url(/fonts/dm-serif.ttf)}</style><style>.outfit { font-family: Outfit, '_font_fallback_1175483161857', sans-serif; } @font-face { font-family: '_font_fallback_1175483161857'; size-adjust: 100.06%; src: local('Arial'); ascent-override: 99.94%; descent-override: 25.98%; line-gap-override: 0.00%; }</style><style>.poppins { font-family: Poppins, '_font_fallback_267554880830', sans-serif; } @font-face { font-family: '_font_fallback_267554880830'; size-adjust: 113.11%; src: local('Arial'); ascent-override: 92.83%; descent-override: 30.94%; line-gap-override: 8.84%; }</style><style>.righteous { font-family: Righteous, '_font_fallback_1710921297547', sans-serif; } @font-face { font-family: '_font_fallback_1710921297547'; size-adjust: 106.09%; src: local('Arial'); ascent-override: 92.83%; descent-override: 24.21%; line-gap-override: 0.00%; }</style><style>.sanchez { font-family: Sanchez, '_font_fallback_640018411127', serif; } @font-face { font-family: '_font_fallback_640018411127'; size-adjust: 121.58%; src: local('Times New Roman'); ascent-override: 82.58%; descent-override: 22.54%; line-gap-override: 0.00%; }</style><style>.dm-serif { font-family: DM Serif Text, '_font_fallback_249424692292', serif; } @font-face { font-family: '_font_fallback_249424692292'; size-adjust: 110.07%; src: local('Times New Roman'); ascent-override: 94.12%; descent-override: 30.44%; line-gap-override: 0.00%; }</style><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1"><meta name="generator" content="Astro v5.15.2"><link rel="alternate" href="https://anhnnp.github.io/blog.xml" type="application/rss+xml"><meta name="title" content="MITOM Blog | Tá»‘i Æ°u &#38; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &#38; AWS S3 + CloudFront"><meta name="description" content="Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (WooCommerce) cáº§n vá»«a nhanh â€“ á»•n Ä‘á»‹nh â€“ báº£o máº­t, láº¡i pháº£i tiáº¿t kiá»‡m chi phÃ­ bÄƒng thÃ´ng vÃ  tÃ i nguyÃªn VPS. BÃ i viáº¿t nÃ y tá»•ng há»£p toÃ n bá»™ cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh mÃ  tÃ´i Ä‘Ã£ triá»ƒn khai thá»±c táº¿: Cloudflare Free, VPS 2 CPU â€“ 8GB RAM cháº¡y OpenLiteSpeed + PHP 8.2, WordPress + WooCommerce, AWS S3 + CloudFront lÃ m CDN áº£nh."><meta property="og:type" content="website"><meta property="og:url" content="https://anhnnp.github.io/blog/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront/"><meta property="og:title" content="Tá»‘i Æ°u &#38; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &#38; AWS S3 + CloudFront"><meta property="og:description" content="Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (WooCommerce) cáº§n vá»«a nhanh â€“ á»•n Ä‘á»‹nh â€“ báº£o máº­t, láº¡i pháº£i tiáº¿t kiá»‡m chi phÃ­ bÄƒng thÃ´ng vÃ  tÃ i nguyÃªn VPS. BÃ i viáº¿t nÃ y tá»•ng há»£p toÃ n bá»™ cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh mÃ  tÃ´i Ä‘Ã£ triá»ƒn khai thá»±c táº¿: Cloudflare Free, VPS 2 CPU â€“ 8GB RAM cháº¡y OpenLiteSpeed + PHP 8.2, WordPress + WooCommerce, AWS S3 + CloudFront lÃ m CDN áº£nh."><meta property="og:image" content="https://anhnnp.github.io/v1/generate/og/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront.png"><meta property="twitter:card" content="summary_large_image"><meta property="twitter:url" content="https://anhnnp.github.io/blog/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront/"><meta property="twitter:title" content="Tá»‘i Æ°u &#38; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &#38; AWS S3 + CloudFront"><meta property="twitter:description" content="Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (WooCommerce) cáº§n vá»«a nhanh â€“ á»•n Ä‘á»‹nh â€“ báº£o máº­t, láº¡i pháº£i tiáº¿t kiá»‡m chi phÃ­ bÄƒng thÃ´ng vÃ  tÃ i nguyÃªn VPS. BÃ i viáº¿t nÃ y tá»•ng há»£p toÃ n bá»™ cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh mÃ  tÃ´i Ä‘Ã£ triá»ƒn khai thá»±c táº¿: Cloudflare Free, VPS 2 CPU â€“ 8GB RAM cháº¡y OpenLiteSpeed + PHP 8.2, WordPress + WooCommerce, AWS S3 + CloudFront lÃ m CDN áº£nh."><meta property="twitter:image" content="https://anhnnp.github.io/v1/generate/og/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront.png"><link rel="canonical" href="https://anhnnp.github.io/blog/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront/"><link rel="icon" type="image/svg" href="/favicon.svg"><title>KÃ½ sá»± MITOM | Tá»‘i Æ°u &amp; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &amp; AWS S3 + CloudFront</title><meta name="astro-view-transitions-enabled" content="true"><meta name="astro-view-transitions-fallback" content="animate"><script type="module" src="/_astro/ClientRouter.astro_astro_type_script_index_0_lang.elfUsALL.js?v=33-a7ecadd"></script><link rel="stylesheet" href="/_astro/_slug_.Bw8pkbQe.css?v=33-a7ecadd">
<style>.astro-code.github-dark code{color:#e1e4e8}.md\:prose :where(:not(pre)>code):not(:where(.not-prose,.not-prose *)):before,.md\:prose :where(:not(pre)>code):not(:where(.not-prose,.not-prose *)):after{display:none}.md\:prose :where(:not(pre)>code):not(:where(.not-prose,.not-prose *)){border-radius:4px;background-color:#dadae1!important;vertical-align:-.05em;padding:3px 5px;font-size:.78em!important;margin:auto 3px;box-shadow:-2px -2px 1px #607d8b}
</style>
<link rel="stylesheet" href="/_astro/_slug_.DvHFXNgD.css?v=33-a7ecadd">
<style>a[data-astro-cid-p7xutspj].brutal-btn{filter:drop-shadow(5px 5px 0 rgb(0 0 0 / 1));background-color:#fff;display:inline-block;padding:.5rem 1rem;border:2px solid black;transition:all;transition-duration:.5s;animation:ease-in-out;font-family:Sanchez,serif}a[data-astro-cid-p7xutspj].brutal-btn:hover{filter:drop-shadow(3px 3px 0 rgb(0 0 0 / 1));background-color:var(--color)}div[data-astro-cid-hnv2b5w7].brutal-card{background-color:var(--color);border-radius:.5rem;border:3px solid black;filter:drop-shadow(7px 7px 0 rgb(0 0 0 / 1));transition:all;padding:1rem;transition-duration:.5s;animation:ease-in-out}div[data-astro-cid-hnv2b5w7].brutal-card:hover{filter:drop-shadow(5px 5px 0 rgb(0 0 0 / 1))}span[data-astro-cid-4z4ikc6r].brutal-pill{filter:drop-shadow(3px 3px 0 rgb(0 0 0 / 1));user-select:none;background-color:#fff;border-radius:9999px;border:2px solid black;padding:.25rem .75rem;transition:all;transition-duration:.5s;animation:ease-in-out;font-size:small}span[data-astro-cid-4z4ikc6r].brutal-pill:hover{filter:drop-shadow(5px 5px 0 rgb(0 0 0 / 1));background-color:var(--color)}
</style></head><body> <header class="border-b-4 border-black flex justify-between p-6 items-center">  <a href="/" title="Quay vá» trang chá»§"> <p class="righteous md:text-5xl">MITOM</p> </a> <nav class="hidden md:inline-block"> <h2 class="hidden">Navigation</h2> <ul class="flex gap-8 poppins"> <li> <a class="text-lg font-medium hover:text-green hover:underline transition-all duration-150 ease-in-out" href="/" title="Go to Trang chá»§"> Trang chá»§ </a> </li><li> <a class="text-lg font-medium hover:text-green hover:underline transition-all duration-150 ease-in-out" href="/blog/" title="Go to BÃ i viáº¿t"> BÃ i viáº¿t </a> </li> <li> <a href="https://github.com/anhnnp" class="hover:text-green hover:underline transition-all duration-150 ease-in-out" target="_blank" title="'See @ElianCodes on GitHub"> <div class="i-uil-github w-6 h-6"></div> </a> </li><li> <a href="https://www.twitter.com/anhnnp" class="hover:text-green hover:underline transition-all duration-150 ease-in-out" target="_blank" title="'See @ElianCodes on Twitter"> <div class="i-uil-twitter w-6 h-6"></div> </a> </li><li> <a href="/feed.xml" class="hover:text-green hover:underline transition-all duration-150 ease-in-out" target="_blank" title="'See @ElianCodes on RSS"> <div class="i-uil-rss w-6 h-6"></div> </a> </li> </ul> </nav> <nav class="md:hidden flex"> <h2 class="hidden">Mobile Navigation</h2> <ul> <li><a href="/blog/">Blog</a></li> </ul> </nav> </header>  <main class="p-6 lg:grid lg:grid-cols-3 flex justify-center"> <aside> <nav class="hidden lg:block sticky top-6"> <ul> <li class="py-1"> <span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-pháº§n-1--cáº¥u-hÃ¬nh-cloudflare-báº£o-máº­t--tá»‘i-Æ°u"> ğŸŸ¦ PHáº¦N 1 â€“ Cáº¥u hÃ¬nh Cloudflare (báº£o máº­t + tá»‘i Æ°u) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#11-báº­t-cÃ¡c-tÃ­nh-nÄƒng-tá»‘c-Ä‘á»™"> 1.1. Báº­t cÃ¡c tÃ­nh nÄƒng tá»‘c Ä‘á»™ </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#12-waf-firewall-rules--block-bot-crawl-ddos"> 1.2. WAF Firewall Rules â€“ block bot, crawl, DDoS </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-1--challenge-toÃ n-bá»™-chÃ¢u-Ã¡--phi"> ğŸ”¹ Rule 1 â€“ Challenge toÃ n bá»™ chÃ¢u Ã â€“ Phi </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-2--block-user-agent-bot--datacenter-bot"> ğŸ”¹ Rule 2 â€“ Block User-Agent bot &amp; Datacenter Bot </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-3--block-xmlrpc-hoáº·c-cÃ¡c-path-url-khÃ¡c"> ğŸ”¹ Rule 3 â€“ Block XMLRPC hoáº·c cÃ¡c path url khÃ¡c </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-4--rate-limit-brute-force-login"> ğŸ”¹ Rule 4 â€“ Rate limit brute force login </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#13-cache-rules-cloudflare--tá»‘i-Æ°u-tá»‘c-Ä‘á»™"> 1.3. Cache Rules Cloudflare â€“ tá»‘i Æ°u tá»‘c Ä‘á»™ </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#caching-configuration-tab"> Caching configuration tab </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-1--cache-fonts-1-year"> ğŸ”¹ Rule 1 â€“ Cache Fonts 1 Year </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-rule-2--cache-wp-content-1-month"> ğŸ”¹ Rule 2 â€“ Cache wp-content 1 Month </a> </li><li class="py-1"> <span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-pháº§n-2--tá»‘i-Æ°u-vps--openlitespeed--wordpress"> ğŸŸ¦ PHáº¦N 2 â€“ Tá»‘i Æ°u VPS / OpenLiteSpeed / Wordpress </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#21-hardening-wordpress-cáº¥p-á»©ng-dá»¥ng"> 2.1. Hardening WordPress (cáº¥p á»©ng dá»¥ng) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-1---táº¯t-file-editing-trong-wp-admin"> ğŸ”¹ STEP 1 - Táº¯t file editing trong wp-admin </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-2---cháº·n-xml-rpc-tá»«-wordpress"> ğŸ”¹ STEP 2 - Cháº·n XML-RPC tá»« WordPress </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-3---cháº·n-thá»±c-thi-php-trong-wp-contentuploads"> ğŸ”¹ STEP 3 - Cháº·n thá»±c thi PHP trong wp-content/uploads </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-4---áº©n-version-wordpress--header-nháº¡y-cáº£m"> ğŸ”¹ STEP 4 - áº¨n version WordPress + header nháº¡y cáº£m </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-5---plugin-security-nháº¹--khÃ´ng-náº·ng-server"> ğŸ”¹ STEP 5 - Plugin security nháº¹ â€“ khÃ´ng náº·ng server </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-6---tá»‘i-Æ°u-litespeed-cache-lscwp"> ğŸ”¹ STEP 6 - Tá»‘i Æ°u LiteSpeed Cache (LSCWP) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#22-hardening-vps--hosting"> 2.2. Hardening VPS / Hosting </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-1--ssh-security-náº¿u-báº¡n-cÃ³-quyá»n-root"> ğŸ”¹ STEP 1 â€“ SSH Security (náº¿u báº¡n cÃ³ quyá»n root) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-2--wordpress-htaccess-security"> ğŸ”¹ STEP 2 â€“ WordPress .htaccess security </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-3--quyá»n-file--folder"> ğŸ”¹ STEP 3 â€“ Quyá»n file &amp; folder </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-4--tá»‘i-Æ°u-php-fpm--opcache"> ğŸ”¹ STEP 4 â€“ Tá»‘i Æ°u PHP-FPM &amp; OPcache </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-4--tá»‘i-Æ°u-mariadb-cho-woocommerce"> ğŸ”¹ STEP 4 â€“ Tá»‘i Æ°u MariaDB cho WooCommerce </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-5--object-cache-redis-cho-woocommerce"> ğŸ”¹ STEP 5 â€“ Object Cache (Redis) cho WooCommerce </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-7--báº£o-vá»‡-woocommerce--tá»‘i-Æ°u-thÃªm"> ğŸ”¹ STEP 7 â€“ Báº£o vá»‡ WooCommerce &amp; tá»‘i Æ°u thÃªm </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-8--backup--monitoring"> ğŸ”¹ STEP 8 â€“ Backup &amp; Monitoring </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#checklist-hoÃ n-háº£o-cho-pháº§n-nÃ y"> Checklist hoÃ n háº£o cho pháº§n nÃ y </a> </li><li class="py-1"> <span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-pháº§n-3--aws-s3--cloudfront-cdn-áº£nh"> ğŸŸ¦ PHáº¦N 3 â€“ AWS S3 + CloudFront (CDN áº£nh) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#31-cloudfront--cáº¥u-hÃ¬nh-viewer--cache-cho-áº£nh"> 3.1. CloudFront â€“ Cáº¥u hÃ¬nh viewer &amp; cache cho áº£nh </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#32-s3-bucket---khÃ³a-cháº·t-bucket--giáº£m-rá»§i-ro"> 3.2. S3 Bucket - KhÃ³a cháº·t bucket &amp; giáº£m rá»§i ro </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#33-hotlink-protection-optional"> 3.3. Hotlink protection (optional) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-1--táº¡o-cloudfront-function-má»›i"> ğŸ”¹ STEP 1 â€“ Táº¡o CloudFront Function má»›i </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-2--dÃ¡n-code-safe-mode-vÃ o-function"> ğŸ”¹ STEP 2 â€“ DÃ¡n code Safe Mode vÃ o function </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-3--publish-function"> ğŸ”¹ STEP 3 â€“ Publish function </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-4--gáº¯n-function-vÃ o-behavior"> ğŸ”¹ STEP 4 â€“ Gáº¯n function vÃ o Behavior </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#-step-5--kiá»ƒm-tra-nhanh"> ğŸ”¹ STEP 5 â€“ Kiá»ƒm tra nhanh </a> </li><li class="py-1"> <span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#4-lifecycle-s3-náº¿u-muá»‘n-tiáº¿t-kiá»‡m-storage"> 4. Lifecycle S3 (náº¿u muá»‘n tiáº¿t kiá»‡m storage) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#41-hiá»ƒu-Ä‘Ãºng-bÃ i-toÃ¡n-tiá»n-báº¡c-má»™t-chÃºt"> 4.1. Hiá»ƒu Ä‘Ãºng bÃ i toÃ¡n tiá»n báº¡c má»™t chÃºt </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#42-lifecycle-cÃ³-lá»£i-nháº¥t-khi-nÃ o"> 4.2. Lifecycle cÃ³ lá»£i nháº¥t khi nÃ o? </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#43-triá»ƒn-khai-má»¥c-tiÃªu-cÃ¡ch-lÃ m"> 4.3. Triá»ƒn khai má»¥c tiÃªu cÃ¡ch lÃ m </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#standard-ia"> Standard-IA </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#glacier-instant-retrieval"> Glacier Instant Retrieval </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#trÃ¡nh-nháº§m-vá»›i-glacier-khÃ´ng-instant-flexible--deep-archive"> TrÃ¡nh nháº§m vá»›i Glacier khÃ´ng Instant (Flexible / Deep Archive) </a> </li><li class="py-1"> <span class="inline-block w-4"></span><span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#44-hÆ°á»›ng-dáº«n-chi-tiáº¿t-táº¡o-lifecycle-rule"> 4.4. HÆ°á»›ng dáº«n chi tiáº¿t táº¡o Lifecycle Rule </a> </li><li class="py-1"> <span class="inline-block w-4"></span> <a class="hover:text-stone transition-all duration-150 ease-in-out text-dark poppins" href="#káº¿t-luáº­n"> Káº¾T LUáº¬N </a> </li> </ul> </nav> </aside> <article class="prose-slate w-sm md:w-prose md:prose poppins"> <a href="/blog/" title="Danh sÃ¡ch bÃ i viáº¿t">&larr; Danh sÃ¡ch bÃ i viáº¿t</a> <p class="text-slate text-sm md:text-base" data-date="{pubDate}">
Ná»™i dung Ä‘Æ°á»£c biÃªn soáº¡n láº¡i tá»« Anh Nguyen - kÃ¨m nguá»“n bÃ i viáº¿t (náº¿u cÃ³)
</p>   <p>Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (WooCommerce) cáº§n vá»«a nhanh â€“ á»•n Ä‘á»‹nh â€“ báº£o máº­t, láº¡i pháº£i tiáº¿t kiá»‡m chi phÃ­ bÄƒng thÃ´ng vÃ  tÃ i nguyÃªn VPS.</p>
<p><img src="/uploads/How%20to%20Offload%20WordPress%20Media%20Files%20to%20Amazon%20S3.webp?v=33-a7ecadd" alt=""></p>
<p>BÃ i viáº¿t nÃ y tá»•ng há»£p toÃ n bá»™ cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh mÃ  tÃ´i Ä‘Ã£ triá»ƒn khai thá»±c táº¿:</p>
<ul>
<li>Cloudflare Free</li>
<li>VPS 2 CPU â€“ 8GB RAM cháº¡y OpenLiteSpeed + PHP 8.2</li>
<li>WordPress + WooCommerce + Theme Flatsome</li>
<li>AWS S3 + CloudFront lÃ m CDN áº£nh</li>
</ul>
<p>ÄÃ¢y lÃ  chuáº©n SOP giÃºp báº¡n Ä‘áº¡t tá»‘c Ä‘á»™ tá»‘i Ä‘a cho khÃ¡ch US/UK/CA/AUS/DE vÃ  giáº£m 70â€“90% bot traffic gÃ¢y tá»‘n tÃ i nguyÃªn.</p>
<h2 id="-pháº§n-1--cáº¥u-hÃ¬nh-cloudflare-báº£o-máº­t--tá»‘i-Æ°u">ğŸŸ¦ <strong>PHáº¦N 1 â€“ Cáº¥u hÃ¬nh Cloudflare (báº£o máº­t + tá»‘i Æ°u)</strong></h2>
<h3 id="11-báº­t-cÃ¡c-tÃ­nh-nÄƒng-tá»‘c-Ä‘á»™">1.1. <strong>Báº­t cÃ¡c tÃ­nh nÄƒng tá»‘c Ä‘á»™</strong></h3>
<p>Chá»n <strong>Domain</strong> > VÃ o má»¥c <strong>Speed</strong> > <strong>Settings</strong></p>
<ul>
<li><strong>Early Hints</strong> â†’ ON</li>
<li><strong>HTTP/2</strong> â†’ ON</li>
<li><strong>HTTP/3</strong> â†’ ON</li>
<li><strong>HTTP/2 to Origin</strong> â†’ ON</li>
<li><strong>Always use HTTPS</strong> â†’ ON</li>
<li><strong>Crawler Hints</strong> â†’ ON</li>
</ul>
<p><img src="/uploads/20251205-114125.png?v=33-a7ecadd" alt=""></p>
<p><strong>1. HTTP/2</strong></p>
<p>HTTP/2 lÃ  phiÃªn báº£n má»›i cá»§a giao thá»©c HTTP, giÃºp trÃ¬nh duyá»‡t vÃ  Cloudflare truyá»n dá»¯ liá»‡u hiá»‡u quáº£ hÆ¡n so vá»›i HTTP/1.1.</p>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li><strong>Táº£i nhanh hÆ¡n</strong>:
<ul>
<li>Há»— trá»£ <em>multiplexing</em>: nhiá»u file (CSS, JS, áº£nhâ€¦) Ä‘Æ°á»£c gá»­i cÃ¹ng lÃºc trÃªn má»™t káº¿t ná»‘i, khÃ´ng pháº£i â€œxáº¿p hÃ ngâ€ tá»«ng file.</li>
<li>Giáº£m sá»‘ lÆ°á»£ng káº¿t ná»‘i TCP pháº£i má»Ÿ.</li>
</ul>
</li>
<li><strong>Giáº£m Ä‘á»™ trá»… (latency)</strong>: tá»‘i Æ°u cho máº¡ng xa nhÆ° user á»Ÿ US, EU truy cáº­p server Viá»‡t Nam hoáº·c ngÆ°á»£c láº¡i.</li>
<li><strong>KhÃ´ng pháº£i chá»‰nh code</strong>: chá»‰ cáº§n báº­t trong Cloudflare, site tá»± hÆ°á»Ÿng lá»£i.</li>
</ul>
<p><strong>áº¢nh hÆ°á»Ÿng SEO &#x26; UX:</strong></p>
<ul>
<li>Page load nhanh hÆ¡n â†’ Core Web Vitals tá»‘t hÆ¡n â†’ há»— trá»£ SEO.</li>
<li>Tráº£i nghiá»‡m ngÆ°á»i dÃ¹ng mÆ°á»£t hÆ¡n, nháº¥t lÃ  trÃªn mobile vÃ  3G/4G.</li>
</ul>
<p><strong>2. HTTP/3</strong></p>
<p>HTTP/3 lÃ  tháº¿ há»‡ tiáº¿p theo, cháº¡y trÃªn giao thá»©c QUIC (dá»±a trÃªn UDP) thay vÃ¬ TCP. NÃ³ Ä‘Æ°á»£c thiáº¿t káº¿ Ä‘á»ƒ xá»­ lÃ½ tá»‘t hÆ¡n cÃ¡c káº¿t ná»‘i khÃ´ng á»•n Ä‘á»‹nh (wifi, mobile).</p>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li><strong>Nhanh hÆ¡n trÃªn máº¡ng cháº­p chá»n</strong>: khi ngÆ°á»i dÃ¹ng di chuyá»ƒn, máº¥t gÃ³i (packet loss), HTTP/3 giá»¯ káº¿t ná»‘i tá»‘t hÆ¡n, giáº£m â€œÄ‘Æ¡â€.</li>
<li><strong>Giáº£m thá»i gian báº¯t tay káº¿t ná»‘i (handshake)</strong>: káº¿t ná»‘i báº£o máº­t Ä‘Æ°á»£c thiáº¿t láº­p nhanh hÆ¡n.</li>
<li><strong>Tá»‘i Æ°u cho mobile-first</strong>: ráº¥t phÃ¹ há»£p vá»›i user á»Ÿ cÃ¡c nÆ°á»›c máº¡ng khÃ´ng á»•n Ä‘á»‹nh.</li>
</ul>
<p><strong>áº¢nh hÆ°á»Ÿng SEO &#x26; UX:</strong></p>
<ul>
<li>GiÃºp <em>First Byte</em> vÃ  <em>Largest Contentful Paint (LCP)</em> nhanh hÆ¡n trong thá»±c táº¿.</li>
<li>Google Chrome, Edge, Firefox Ä‘á»u support nÃªn báº­t lÃ  â€œfree performanceâ€.</li>
</ul>
<p><strong>3. HTTP/2 to Origin</strong></p>
<p>Pháº§n HTTP/2 á»Ÿ trÃªn lÃ  giá»¯a trÃ¬nh duyá»‡t â†” Cloudflare.
CÃ²n HTTP/2 to Origin lÃ  giá»¯a Cloudflare â†” server gá»‘c cá»§a báº¡n (origin server).</p>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li>TÄƒng tá»‘c Ä‘Æ°á»ng ná»™i bá»™: khi Cloudflare pháº£i request ná»™i dung tá»« server (cache miss), nÃ³ dÃ¹ng HTTP/2 Ä‘á»ƒ láº¥y data nhanh hÆ¡n.</li>
<li>Giáº£m táº£i server: Ã­t káº¿t ná»‘i TCP hÆ¡n, server Ä‘á»¡ â€œngá»™pâ€ khi nhiá»u request.</li>
<li>Tá»‘i Æ°u cho site nhiá»u file nhá» (store, blog, nhiá»u áº£nh, JS, CSS).</li>
</ul>
<p><strong>LÆ°u Ã½ ká»¹ thuáº­t:</strong></p>
<ul>
<li>Origin server cáº§n support HTTP/2 (Ä‘a sá»‘ hosting má»›i Ä‘á»u cÃ³).</li>
<li>Náº¿u origin khÃ´ng há»— trá»£, Cloudflare sáº½ fallback láº¡i HTTP/1.1 â€“ khÃ´ng lá»—i, chá»‰ khÃ´ng tá»‘i Æ°u.</li>
</ul>
<p><strong>4. Always use HTTPS</strong></p>
<p>Tá»± Ä‘á»™ng redirect táº¥t cáº£ HTTP â†’ HTTPS. Náº¿u ngÆ°á»i dÃ¹ng hoáº·c bot truy cáº­p <code>http://example.com</code>, Cloudflare sáº½ chuyá»ƒn sang <code>https://example.com</code>.</p>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li>Äáº£m báº£o toÃ n bá»™ traffic Ä‘Æ°á»£c mÃ£ hÃ³a: chá»‘ng nghe lÃ©n, chá»‰nh sá»­a ná»™i dung giá»¯a Ä‘Æ°á»ng.</li>
<li>TrÃ¡nh content bá»‹ trá»™n HTTP/HTTPS: giáº£m lá»—i â€œNot secureâ€ trong trÃ¬nh duyá»‡t.</li>
<li>Chuáº©n hoÃ¡ URL: luÃ´n má»™t phiÃªn báº£n HTTPS, tá»‘t cho SEO &#x26; trÃ¡nh duplicate.</li>
</ul>
<p><strong>Best practice:</strong></p>
<ul>
<li>Káº¿t há»£p vá»›i â€œAutomatic HTTPS Rewritesâ€ (náº¿u cáº§n) Ä‘á»ƒ chuyá»ƒn link ná»™i bá»™ tá»« http â†’ https.</li>
<li>á» server (ngang Nginx/Apache) váº«n nÃªn cáº¥u hÃ¬nh redirect HTTPâ†’HTTPS, nhÆ°ng Cloudflare Ä‘Ã£ xá»­ lÃ½ pháº§n lá»›n.</li>
</ul>
<p><strong>5. TLS 1.3</strong></p>
<p>TLS lÃ  giao thá»©c báº£o máº­t dÃ¹ng cho HTTPS. TLS 1.3 lÃ  phiÃªn báº£n má»›i nháº¥t, nhanh hÆ¡n vÃ  an toÃ n hÆ¡n TLS 1.0/1.1/1.2.</p>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li>Handshake nhanh hÆ¡n: giáº£m sá»‘ round-trip khi trÃ¬nh duyá»‡t thiáº¿t láº­p káº¿t ná»‘i báº£o máº­t â†’ response nhanh hÆ¡n.</li>
<li>Báº£o máº­t cao hÆ¡n: bá» nhiá»u thuáº­t toÃ¡n cÅ© yáº¿u, chá»‰ dÃ¹ng cipher máº¡nh.</li>
<li>Future-proof: cÃ¡c trÃ¬nh duyá»‡t má»›i Æ°u tiÃªn TLS 1.3.</li>
</ul>
<p><strong>áº¢nh hÆ°á»Ÿng thá»±c táº¿:</strong></p>
<ul>
<li>Site váº«n hoáº¡t Ä‘á»™ng vá»›i client cÅ© (vÃ­ dá»¥ chá»‰ há»— trá»£ TLS 1.2), Cloudflare sáº½ tá»± downgrade â†’ khÃ´ng pháº£i lo máº¥t user.</li>
<li>Äáº·c biá»‡t há»¯u Ã­ch khi cÃ³ nhiá»u request nhá» (AJAX, API, fontâ€¦).</li>
</ul>
<p><strong>6. Early Hints</strong></p>
<p>Early Hints (HTTP status 103) cho phÃ©p Cloudflare gá»­i gá»£i Ã½ sá»›m cho trÃ¬nh duyá»‡t trÆ°á»›c khi response chÃ­nh tá»« server gá»‘c sáºµn sÃ ng.</p>
<p>VÃ­ dá»¥:
Server gá»‘c máº¥t ~500ms Ä‘á»ƒ generate HTML. Trong lÃºc chá», Cloudflare gá»­i Early Hints nÃ³i:</p>
<blockquote>
<p>â€œTrÃ¬nh duyá»‡t Æ¡i, lÃ¡t ná»¯a tao sáº½ cáº§n file CSS/JS/Font nÃ y, mÃ y cá»© load trÆ°á»›c Ä‘i.â€</p>
</blockquote>
<p><strong>TÃ¡c dá»¥ng chÃ­nh:</strong></p>
<ul>
<li>Giáº£m thá»i gian táº£i tÃ i nguyÃªn quan trá»ng (CSS, JS, fonts, critical images).</li>
<li>Cáº£i thiá»‡n Largest Contentful Paint (LCP) vÃ¬ browser báº¯t Ä‘áº§u táº£i asset sá»›m hÆ¡n.</li>
<li>Ráº¥t tá»‘t cho site Ä‘á»™ng (WordPress, Shopify app náº·ng, trang cÃ³ nhiá»u logic).</li>
</ul>
<p><strong>LÆ°u Ã½:</strong></p>
<ul>
<li>KhÃ´ng cáº§n sá»­a code, chá»‰ cáº§n Cloudflare biáº¿t Ä‘Æ°á»£c cÃ¡c <code>link rel="preload"</code>, <code>rel="preconnect"</code>, v.vâ€¦ trong HTML lÃ  nÃ³ cÃ³ thá»ƒ gá»­i Early Hints.</li>
<li>KhÃ´ng gÃ¢y lá»—i náº¿u trÃ¬nh duyá»‡t khÃ´ng há»— trá»£; browser cÅ© sáº½ Ä‘Æ¡n giáº£n bá» qua.</li>
</ul>
<p><strong>TÃ³m táº¯t ngáº¯n cho cÃ¡c pháº§n Ä‘Ã³ nhÆ° sau:</strong></p>
<ul>
<li><strong>HTTP/2</strong>: Nhiá»u file Ä‘i chung má»™t Ä‘Æ°á»ng â†’ táº£i trang nhanh hÆ¡n.</li>
<li><strong>HTTP/3</strong>: Tá»‘i Æ°u máº¡ng cháº­p chá»n, mobile, wifi â†’ giáº£m lag.</li>
<li><strong>HTTP/2 to Origin</strong>: TÄƒng tá»‘c Ä‘oáº¡n Cloudflare â†” server gá»‘c â†’ giáº£m táº£i server.</li>
<li><strong>Always use HTTPS</strong>: Báº¯t buá»™c toÃ n site cháº¡y HTTPS â†’ an toÃ n &#x26; chuáº©n SEO.</li>
<li><strong>TLS 1.3</strong>: PhiÃªn báº£n báº£o máº­t HTTPS má»›i nháº¥t â†’ nhanh hÆ¡n, an toÃ n hÆ¡n.</li>
<li><strong>Early Hints</strong>: Gá»­i â€œhintâ€ táº£i CSS/JS/Font sá»›m â†’ cáº£i thiá»‡n LCP, site â€œfeelâ€ nhanh hÆ¡n.</li>
</ul>
<h3 id="12-waf-firewall-rules--block-bot-crawl-ddos">1.2. <strong>WAF Firewall Rules â€“ block bot, crawl, DDoS</strong></h3>
<p>TrÆ°á»›c háº¿t, Báº­t <strong>Bot Fight Mode</strong></p>
<p><img src="/uploads/20251205-153224.png?v=33-a7ecadd" alt=""></p>
<h4 id="-rule-1--challenge-toÃ n-bá»™-chÃ¢u-Ã¡--phi">ğŸ”¹ Rule 1 â€“ Challenge toÃ n bá»™ chÃ¢u Ã â€“ Phi</h4>
<p><strong>Rule Name:</strong> Challenge non America Europe traffic</p>
<p>VÃ¬ site hÆ°á»›ng US/UK/CA/AUS/DE nÃªn ngoáº¡i trá»« cÃ¡c khu vá»±c nÃ y sáº½ bá»‹ xÃ¡c thá»±c trÃ¡nh bot scan.</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>not (ip.geoip.continent in {"NA" "SA" "EU" "OC"})</span></span></code></pre>
<p>â†’ <strong>Action:</strong> Managed Challenge</p>
<p><img src="/uploads/20251205-153350.png?v=33-a7ecadd" alt=""></p>
<h4 id="-rule-2--block-user-agent-bot--datacenter-bot">ğŸ”¹ Rule 2 â€“ Block User-Agent bot &#x26; Datacenter Bot</h4>
<p><strong>Rule Name:</strong> Block Cloud &#x26; Scraper Bots (Combo)</p>
<p>Request tá»« AWS, Azure, Alibaba, Tencent, Hetzner, OVH, DO, Vultr Ä‘á»u bá»‹ block.</p>
<p>â†’ <strong>Action</strong>: Block</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>(not cf.client.bot)</span></span>
<span class="line"><span>and</span></span>
<span class="line"><span>(</span></span>
<span class="line"><span>  ip.geoip.asnum in {16509 14618 45102 37963 132203 45090}</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "headlesschrome"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "puppeteer"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "selenium"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "phantomjs"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "playwright"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "python-requests"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "aiohttp"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "httpx"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "curl"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "wget"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "scrapy"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "java"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "go-http-client"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "okhttp"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "axios"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "node-fetch"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "httpclient"</span></span>
<span class="line"><span>  or lower(http.request.headers["user-agent"][0]) contains "libwww"</span></span>
<span class="line"><span>)</span></span></code></pre>
<p><img src="/uploads/20251205-153518.png?v=33-a7ecadd" alt=""></p>
<h4 id="-rule-3--block-xmlrpc-hoáº·c-cÃ¡c-path-url-khÃ¡c">ğŸ”¹ Rule 3 â€“ Block XMLRPC hoáº·c cÃ¡c path url khÃ¡c</h4>
<p>(dÃ¹ Ä‘Ã£ táº¯t tá»« WP vÃ  Server)</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>http.request.uri.path eq "/xmlrpc.php"</span></span></code></pre>
<p>â†’ <strong>Action</strong>: Block</p>
<h4 id="-rule-4--rate-limit-brute-force-login">ğŸ”¹ Rule 4 â€“ Rate limit brute force login</h4>
<p><strong>Rule Name:</strong> Rate Limiting prevent brute force URL login</p>
<p>PhiÃªn báº£n Cloudflare Free chá»‰ Ä‘Æ°á»£c 1 rule duy nháº¥t, váº­y hÃ£y tá»•ng há»£p vÃ  táº¡o 1 rule nÃ y thÃ´i.</p>
<p><strong>Expression:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>(</span></span>
<span class="line"><span>  http.request.uri.path eq "/wp-login.php"</span></span>
<span class="line"><span>  or http.request.uri.path eq "/url-limit-request"</span></span>
<span class="line"><span>)</span></span></code></pre>
<p><strong>Rate limit:</strong></p>
<ul>
<li>5 request / 10s / IP</li>
<li>Action: Managed Challenge</li>
</ul>
<p>âœ” <strong>KhÃ´ng sá»­ dá»¥ng rate limit cho /product /collection /uploads</strong> â†’ Náº¿u tÆ°Æ¡ng lai bá»‹ scan vÃ  crawls nhiá»u hÆ¡n ta cÃ³ thá»ƒ táº¡o Rate Limiting nhÆ° sau:</p>
<ul>
<li>1 rule cho toÃ n site (60 req/10s/IP â†’ challenge)</li>
<li>1 rule cho <code>/product/</code> + <code>/shop/</code> (20 req/10s/IP)</li>
<li>1 rule cho <code>/wp-content/uploads/</code> (30 req/10s/IP)</li>
</ul>
<h3 id="13-cache-rules-cloudflare--tá»‘i-Æ°u-tá»‘c-Ä‘á»™">1.3. <strong>Cache Rules Cloudflare â€“ tá»‘i Æ°u tá»‘c Ä‘á»™</strong></h3>
<h4 id="caching-configuration-tab"><strong>Caching configuration tab</strong></h4>
<ul>
<li>Caching Level: <strong>Standard</strong> â†’ Best practice</li>
<li>Browser Cache TTL: <strong>4 hours</strong> â†’ há»£p lÃ½ (Google Ä‘Ã¡nh giÃ¡ tá»‘t)</li>
<li>Crawler Hints: <strong>ON</strong> â†’ ráº¥t tá»‘t</li>
<li>Always Online: <strong>ON</strong> â†’ an toÃ n</li>
<li>Development mode: <strong>OFF</strong> â†’ Ä‘Ãºng</li>
<li>CSAM OFF/ON khÃ´ng áº£nh hÆ°á»Ÿng Ä‘á»ƒ nguyÃªn</li>
</ul>
<p><img src="/uploads/20251205-155131.png?v=33-a7ecadd" alt=""></p>
<h4 id="-rule-1--cache-fonts-1-year">ğŸ”¹ Rule 1 â€“ Cache Fonts 1 Year</h4>
<p>Báº¡n Ä‘ang match theo:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>http.request.uri.path contains "/wp-content/fonts/"</span></span>
<span class="line"><span>or</span></span>
<span class="line"><span>http.request.uri.path contains "/wp-content/themes/flatsome/assets/css/icons/"</span></span>
<span class="line"><span>Edge TTL: 1 year</span></span>
<span class="line"><span>Browser TTL: 1 year</span></span></code></pre>
<p>â†’ ÄÃ¢y lÃ  path háº¹p vÃ  chá»‰ dÃ nh cho font.</p>
<h4 id="-rule-2--cache-wp-content-1-month">ğŸ”¹ Rule 2 â€“ Cache wp-content 1 Month</h4>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>http.request.full_uri wildcard "*wp-content/*"</span></span>
<span class="line"><span>Edge TTL: 1 month</span></span>
<span class="line"><span>Browser TTL: 1 month</span></span></code></pre>
<p>VÃ¬ rule Fonts náº±m trÆ°á»›c, font match rule 1 â†’ khÃ´ng bao giá» bá»‹ rule 2 Ä‘Ã¨.</p>
<p><img src="/uploads/20251205-223717.png?v=33-a7ecadd" alt=""></p>
<p>ÄÃ¢y chÃ­nh lÃ  Best Practice Cloudflare chuáº©n dÃ nh cho:</p>
<ul>
<li>WooCommerce</li>
<li>WordPress</li>
<li>CÃ¡c theme nhÆ° Flatsome / Astra / GeneratePress</li>
<li>Site phá»¥c vá»¥ USA UK CA AUS</li>
</ul>
<p>Font (woff2 / woff / ttf / icon font) lÃ  resource:</p>
<ul>
<li>Gáº§n nhÆ° khÃ´ng thay Ä‘á»•i</li>
<li>Cáº§n cache cá»±c lÃ¢u Ä‘á»ƒ tÄƒng Core Web Vitals (FCP)</li>
<li>Táº£i siÃªu nháº¹ â†’ cache lÃ¢u giÃºp tÄƒng tá»‘c ráº¥t nhiá»u</li>
</ul>
<p>Trong khi cÃ¡c file bÃªn <code>/wp-content/</code> khÃ¡c nhÆ°:</p>
<ul>
<li>áº¢nh sáº£n pháº©m</li>
<li>áº¢nh upload</li>
<li>File CSS/JS cá»§a cache plugin</li>
<li>Thumbnail WooCommerce</li>
<li>File builder (UX Builder cá»§a Flatsome)</li>
</ul>
<p>â†’ Nhá»¯ng thá»© thay Ä‘á»•i thÆ°á»ng xuyÃªn â†’ Cache 30 ngÃ y lÃ  há»£p lÃ½.</p>
<p>Náº¿u báº¡n muá»‘n cáº¥u hÃ¬nh cache theo Ä‘á»™ Æ°u tiÃªn thÃ´ng minh hÆ¡n thÃ¬ Ä‘Ã¢y lÃ  chuáº©n PRO:</p>
<ul>
<li><strong>Rule 1</strong> â†’ Cache Fonts (365 days)</li>
<li><strong>Rule 2</strong> â†’ Cache wp-content theme assets (60â€“90 days)</li>
<li><strong>Rule 3</strong> â†’ Cache wp-content uploads (30 days)</li>
<li><strong>Rule 4</strong> â†’ Global caching (5 min â€“ default)</li>
</ul>
<p>NhÆ°ng vá»›i Cloudflare Free, báº¡n chá»‰ cÃ³ 10 Cache Rules, vÃ  hiá»‡n táº¡i setup cá»§a báº¡n lÃ  Ráº¤T Tá»T rá»“i.</p>
<p><strong>Checklist láº¡i tá»•ng káº¿t toÃ n bá»™ cloudflare bÃªn trÃªn nhÆ° sau:</strong></p>











































































<table><thead><tr><th>Háº¡ng má»¥c</th><th>Tráº¡ng thÃ¡i cá»§a báº¡n</th><th>ÄÃ¡nh giÃ¡</th></tr></thead><tbody><tr><td>Block bad UA</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Geo Challenge ngoÃ i NA/EU/OC</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Block Cloud ASN bots</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Challenge wp-login / xmlrpc</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Rate Limit brute force</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Cache Rule /fonts/</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Cache Rule /wp-content/</td><td>âœ” OK</td><td>Perfect</td></tr><tr><td>Caching Level Standard</td><td>âœ” OK</td><td>Best</td></tr><tr><td>Crawler Hints</td><td>âœ” ON</td><td>Good</td></tr><tr><td>Always Online</td><td>âœ” ON</td><td>Good</td></tr><tr><td>Brotli</td><td>âš  ChÆ°a thÃªm</td><td>Should Enable</td></tr><tr><td>Early Hints</td><td>âš  ChÆ°a thÃªm</td><td>Should Enable</td></tr><tr><td>Edge Cache TTL</td><td>âš  ChÆ°a thÃªm</td><td>Should Enable</td></tr></tbody></table>
<h2 id="-pháº§n-2--tá»‘i-Æ°u-vps--openlitespeed--wordpress">ğŸŸ¦ <strong>PHáº¦N 2 â€“ Tá»‘i Æ°u VPS / OpenLiteSpeed / Wordpress</strong></h2>
<h3 id="21-hardening-wordpress-cáº¥p-á»©ng-dá»¥ng">2.1. Hardening WordPress (cáº¥p á»©ng dá»¥ng)</h3>
<p>CÆ¡ báº£n ta sáº½ thay Ä‘á»•i cÃ¡c cÃ i Ä‘áº·t nhÆ° dÆ°á»›i Ä‘Ã¢y:</p>
<ul>
<li>DISALLOW_FILE_EDIT = true</li>
<li>Disable XML-RPC</li>
<li>Giá»›i háº¡n Login (LSCache / Cloudflare / AIOWPS)</li>
<li>áº¨n version WordPress</li>
<li>Cháº·n User Enumeration</li>
<li>Kiá»ƒm tra plugin/theme kÃ©m cháº¥t lÆ°á»£ng</li>
</ul>
<h4 id="-step-1---táº¯t-file-editing-trong-wp-admin">ğŸ”¹ STEP 1 - Táº¯t file editing trong wp-admin</h4>
<p>NgÄƒn hacker sá»­a theme/plugin trong admin náº¿u bá»‹ vÃ o Ä‘Æ°á»£c.</p>
<p>ThÃªm vÃ o cuá»‘i file <code>wp-config.php</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>define( 'DISALLOW_FILE_EDIT', true );</span></span>
<span class="line"><span>define( 'DISALLOW_FILE_MODS', false ); // váº«n cho phÃ©p update plugin/core</span></span></code></pre>
<h4 id="-step-2---cháº·n-xml-rpc-tá»«-wordpress">ğŸ”¹ STEP 2 - Cháº·n XML-RPC tá»« WordPress</h4>
<p>Báº¡n Ä‘Ã£ cháº·n báº±ng Cloudflare, nhÆ°ng táº¯t luÃ´n tá»« server lÃ  tá»‘t nháº¥t.</p>
<p><strong>Náº¿u dÃ¹ng .htaccess (Apache/LiteSpeed):</strong></p>
<p>Trong root WordPress (nÆ¡i cÃ³ wp-config.php), thÃªm:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>&#x3C;Files "xmlrpc.php"></span></span>
<span class="line"><span>    Order Allow,Deny</span></span>
<span class="line"><span>    Deny from all</span></span>
<span class="line"><span>&#x3C;/Files></span></span></code></pre>
<h4 id="-step-3---cháº·n-thá»±c-thi-php-trong-wp-contentuploads">ğŸ”¹ STEP 3 - Cháº·n thá»±c thi PHP trong <code>wp-content/uploads</code></h4>
<p>ÄÃ¢y lÃ  Ä‘iá»ƒm ráº¥t thÆ°á»ng bá»‹ hack (upload shell).</p>
<p><strong>Apache/.htaccess (táº¡o file .htaccess trong thÆ° má»¥c <code>/wp-content/uploads/</code>):</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span># Block PHP execution in uploads</span></span>
<span class="line"><span>&#x3C;FilesMatch "\.php$"></span></span>
<span class="line"><span>    &#x3C;IfModule mod_authz_core.c></span></span>
<span class="line"><span>        Require all denied</span></span>
<span class="line"><span>    &#x3C;/IfModule></span></span>
<span class="line"><span>    &#x3C;IfModule !mod_authz_core.c></span></span>
<span class="line"><span>        Order deny,allow</span></span>
<span class="line"><span>        Deny from all</span></span>
<span class="line"><span>    &#x3C;/IfModule></span></span>
<span class="line"><span>&#x3C;/FilesMatch></span></span></code></pre>
<h4 id="-step-4---áº©n-version-wordpress--header-nháº¡y-cáº£m">ğŸ”¹ STEP 4 - áº¨n version WordPress + header nháº¡y cáº£m</h4>
<p>Trong <code>functions.php</code> cá»§a child theme hoáº·c plugin riÃªng:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>remove_action('wp_head', 'wp_generator');</span></span></code></pre>
<p>Náº¿u hosting há»— trá»£, báº­t cÃ¡c security header (báº¡n Ä‘Ã£ báº­t tá»« Cloudflare má»™t pháº§n rá»“i, nÃªn á»Ÿ Ä‘Ã¢y chá»‰ cáº§n tá»‘i thiá»ƒu).</p>
<h4 id="-step-5---plugin-security-nháº¹--khÃ´ng-náº·ng-server">ğŸ”¹ STEP 5 - Plugin security nháº¹ â€“ khÃ´ng náº·ng server</h4>
<p>Náº¿u chÆ°a cÃ³:</p>
<ul>
<li>CÃ i <strong>Wordfence Free</strong> hoáº·c <strong>All In One WP Security &#x26; Firewall</strong></li>
<li>Báº­t:
<ul>
<li>Limit login attempts</li>
<li>Rename login URL (báº¡n Ä‘Ã£ Ä‘á»•i rá»“i, nhÆ°ng plugin giÃºp quáº£n lÃ½ dá»… hÆ¡n)</li>
<li>Spam comment protection náº¿u báº¡n báº­t comment</li>
</ul>
</li>
</ul>
<p>LÆ°u Ã½: háº¡n cháº¿ dÃ¹ng quÃ¡ nhiá»u plugin security náº·ng (Ã­t thÃ´i).</p>
<p><strong>CÃ i plugin Ä‘á»ƒ dá»n DB, dÃ¹ng 1 trong 2:</strong></p>
<ul>
<li>WP-Optimize</li>
<li>Advanced Database Cleaner</li>
</ul>
<p>Äá»ƒ lÃ m cÃ¡c nhiá»‡m vá»¥:</p>
<ul>
<li>XÃ³a revision post cÅ©</li>
<li>XÃ³a auto-draft</li>
<li>XÃ³a trash</li>
<li>XÃ³a transients háº¿t háº¡n</li>
<li>Dá»n báº£ng <code>wp_woocommerce_sessions</code> náº¿u phÃ¬nh to</li>
</ul>
<p>Cháº¡y thá»§ cÃ´ng, Ä‘á»«ng auto cron quÃ¡ dÃ y (1 láº§n/tuáº§n lÃ  Ä‘Æ°á»£c).</p>
<h4 id="-step-6---tá»‘i-Æ°u-litespeed-cache-lscwp">ğŸ”¹ STEP 6 - Tá»‘i Æ°u LiteSpeed Cache (LSCWP)</h4>
<p>Báº¡n Ä‘ang dÃ¹ng OpenLiteSpeed nÃªn plugin LiteSpeed Cache (LSCWP) LÃ€ Tá»T NHáº¤T (KHÃ”NG nÃªn dÃ¹ng WP Super Cache / Autoptimize / WP Rocket).</p>
<p><strong>Cache Settings</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span># General</span></span>
<span class="line"><span>Enable Cache: ON</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Cache</span></span>
<span class="line"><span>Cache Logged-in Users: OFF</span></span>
<span class="line"><span>Cache Commenters: OFF</span></span>
<span class="line"><span>Cache REST API: ON</span></span>
<span class="line"><span>Cache Login page: OFF</span></span>
<span class="line"><span>Cache Mobile: ON</span></span>
<span class="line"><span>Cache WooCommerce: ON</span></span>
<span class="line"><span></span></span>
<span class="line"><span># TTL</span></span>
<span class="line"><span>Default Public TTL: 604800 (7 days)</span></span>
<span class="line"><span>Default Front Page TTL: 86400 (24 hours)</span></span>
<span class="line"><span>WooCommerce Product TTL: 604800 (7 days)</span></span>
<span class="line"><span></span></span>
<span class="line"><span># Purge - Ráº¥t tá»‘t khi server báº­n, user váº«n táº£i cache cÅ©.</span></span>
<span class="line"><span>Purge all on upgrade: ON</span></span>
<span class="line"><span>Serve Stale: ON</span></span>
<span class="line"><span></span></span>
<span class="line"><span></span></span>
<span class="line"><span># ESI (Edge Side Includes)</span></span>
<span class="line"><span>Enable ESI: ON</span></span>
<span class="line"><span>ESI Admin bar: ON</span></span>
<span class="line"><span>ESI Cart: ON</span></span></code></pre>
<p>ESI lÃ  thá»© khiáº¿n WooCommerce cháº¡y nhanh gáº¥p 2â€“3 láº§n, vÃ¬ giá» hÃ ng, wishlist Ä‘Æ°á»£c xá»­ lÃ½ riÃªng.</p>
<p><strong>Optimize (CSS/JS/HTML UGLIFY)</strong></p>
<p>LSCWP â†’ Page Optimization:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span># CSS</span></span>
<span class="line"><span>CSS Minify: ON</span></span>
<span class="line"><span>CSS Combine: OFF (Flatsome siÃªu linh hoáº¡t â†’ khÃ´ng combine)</span></span>
<span class="line"><span>CSS HTTP/2 Push: OFF (HTTP/3 khÃ´ng cáº§n)</span></span>
<span class="line"><span></span></span>
<span class="line"><span>#JS</span></span>
<span class="line"><span>JS Minify: ON</span></span>
<span class="line"><span>JS Combine: OFF</span></span>
<span class="line"><span>JS Defer: ON</span></span>
<span class="line"><span>JS Deferred Excludes:</span></span>
<span class="line"><span>	jquery.js</span></span>
<span class="line"><span>	jquery.min.js</span></span>
<span class="line"><span></span></span>
<span class="line"><span># HTML</span></span>
<span class="line"><span>Minify HTML: ON</span></span>
<span class="line"><span>DNS Prefetch: your CDN AWS CloudFront domain (náº¿u dÃ¹ng)</span></span>
<span class="line"><span>Remove Comments: ON</span></span>
<span class="line"><span>Remove Query Strings: ON</span></span></code></pre>
<p><strong>Image Optimization</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Image Optimization â†’ Optimize Automatically: ON</span></span>
<span class="line"><span>WebP: ON</span></span>
<span class="line"><span>WebP Replacement: ON</span></span>
<span class="line"><span>Lazy Load Images: ON</span></span></code></pre>
<p><strong>Excludes</strong> (Ä‘á»ƒ trÃ¡nh lazy load logo, icon)</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>logo.png</span></span>
<span class="line"><span>.svg</span></span>
<span class="line"><span>.webp</span></span></code></pre>
<p><strong>Object Cache (Redis)</strong></p>
<p>Trong LSCWP â†’ Object Cache â†’ báº­t:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Object Cache: Enable</span></span>
<span class="line"><span>Method: Redis</span></span>
<span class="line"><span>Host: 127.0.0.1</span></span>
<span class="line"><span>Persistent Connection: ON</span></span>
<span class="line"><span>Cache TTL: 3600</span></span></code></pre>
<p>â†’ Redis giÃºp giáº£m truy váº¥n DB cá»§a WooCommerce 50â€“70%.</p>
<p><strong>Khi dÃ¹ng plugin LiteSpeed Cache (best, khÃ´ng cáº§n plugin khÃ¡c):</strong></p>
<ul>
<li>Táº¯t chá»©c nÄƒng â€œHTML minify / CSS minifyâ€ náº¿u báº¡n Ä‘Ã£ Ä‘á»ƒ Cloudflare lÃ m (Ä‘á»ƒ trÃ¡nh xung Ä‘á»™t).</li>
<li>Äáº£m báº£o DONâ€™T báº­t â€œFull page cache for logged-in usersâ€ (WooCommerce cáº§n phÃ¢n trang cho giá» hÃ ng).</li>
</ul>
<h3 id="22-hardening-vps--hosting">2.2. Hardening VPS / Hosting</h3>
<h4 id="-step-1--ssh-security-náº¿u-báº¡n-cÃ³-quyá»n-root">ğŸ”¹ STEP 1 â€“ SSH Security (náº¿u báº¡n cÃ³ quyá»n root)</h4>
<ul>
<li>Äá»•i port SSH (vÃ­ dá»¥ 22 â†’ 2222)</li>
<li>Táº¯t login báº±ng password, chá»‰ dÃ¹ng SSH key</li>
<li>CÃ i <strong>fail2ban</strong> Ä‘á»ƒ cháº·n brute-force SSH &#x26; HTTP (optional nhÆ°ng tá»‘t)</li>
</ul>
<p>Náº¿u báº¡n SSH vÃ o VPS:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>apt install fail2ban -y</span></span></code></pre>
<p>Táº¡o file:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>/etc/fail2ban/jail.local</span></span></code></pre>
<p>ThÃªm:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>[sshd]</span></span>
<span class="line"><span>enabled = true</span></span>
<span class="line"><span>maxretry = 5</span></span>
<span class="line"><span>findtime = 10m</span></span>
<span class="line"><span>bantime = 24h</span></span></code></pre>
<p>â†’ Cháº·n IP brute-force SSH.</p>
<h4 id="-step-2--wordpress-htaccess-security">ğŸ”¹ STEP 2 â€“ <strong>WordPress .htaccess security</strong></h4>
<p><strong>Cháº·n PHP trong uploads</strong></p>
<p>Táº¡o file:
<code>/wp-content/uploads/.htaccess</code></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>&#x3C;FilesMatch "\.php$"></span></span>
<span class="line"><span>  Require all denied</span></span>
<span class="line"><span>&#x3C;/FilesMatch></span></span></code></pre>
<p><strong>Táº¯t directory listing</strong></p>
<p>Trong <code>.htaccess</code> gá»‘c thÃªm:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Options -Indexes</span></span></code></pre>
<h4 id="-step-3--quyá»n-file--folder">ğŸ”¹ STEP 3 â€“ Quyá»n file &#x26; folder</h4>
<p>SSH vÃ o root WP:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>find . -type d -exec chmod 755 {} \;</span></span>
<span class="line"><span>find . -type f -exec chmod 644 {} \;</span></span>
<span class="line"><span>chmod 600 wp-config.php</span></span></code></pre>
<p>GiÃºp giáº£m nguy cÆ¡ bá»‹ Ä‘á»c file config / chÃ¨n mÃ£.</p>
<h4 id="-step-4--tá»‘i-Æ°u-php-fpm--opcache">ğŸ”¹ STEP 4 â€“ Tá»‘i Æ°u PHP-FPM &#x26; OPcache</h4>
<p><strong>OLS Panel â†’ Server â†’ Security</strong></p>
<ul>
<li>Enable Brute Force Protection: ON</li>
<li>Dynamic Response: 404</li>
<li>Soft Limit: 5</li>
<li>Hard Limit: 10</li>
</ul>
<p><strong>Báº­t QUIC + HTTP/3 (náº¿u chÆ°a báº­t)</strong></p>
<p>VÃ o OpenLiteSpeed Panel â†’ Listener â†’ SSL â†’ Protocols</p>
<ul>
<li>HTTP/2</li>
<li>HTTP/3</li>
<li>QUIC</li>
</ul>
<p>â†’ ÄÃ¢y lÃ  Ä‘iá»ƒm boost tá»‘c Ä‘á»™ cá»±c lá»›n cho user USA/UK/AUS.</p>
<p><strong>Báº­t OPcache</strong></p>
<p>Trong <code>php.ini</code> (hoáº·c <code>conf.d/opcache.ini</code>) Ä‘Æ°á»ng dáº«n nhÆ° dÆ°á»›i:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>/usr/local/lsws/lsphp82/etc/php/8.2/litespeed/php.ini</span></span>
<span class="line"><span>hoáº·c</span></span>
<span class="line"><span>/etc/php/8.2/litespeed/php.ini</span></span></code></pre>
<p>ThÃªm hoáº·c sá»­a:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>opcache.enable=1</span></span>
<span class="line"><span>opcache.enable_cli=1</span></span>
<span class="line"><span>opcache.memory_consumption=256</span></span>
<span class="line"><span>opcache.interned_strings_buffer=32</span></span>
<span class="line"><span>opcache.max_accelerated_files=20000</span></span>
<span class="line"><span>opcache.revalidate_freq=60</span></span></code></pre>
<ul>
<li>Vá»›i WooCommerce, <code>opcache.memory_consumption=256</code> lÃ  tá»‘i Æ°u (2GB VPS + 8GB RAM).</li>
<li>Flatsome + WooCommerce load nhiá»u file PHP.</li>
</ul>
<p><strong>PHP-FPM (lsphp) tuning</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>/usr/local/lsws/conf/httpd_config.conf</span></span></code></pre>
<p><code>phpIniOverride</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>max_execution_time=300</span></span>
<span class="line"><span>memory_limit=1024M</span></span>
<span class="line"><span>post_max_size=64M</span></span>
<span class="line"><span>upload_max_filesize=64M</span></span>
<span class="line"><span>max_input_vars=5000</span></span></code></pre>
<p>â†’ WooCommerce + Flatsome cáº§n memory_limit lá»›n (>=512MB).
â†’ VPS cá»§a báº¡n RAM 8GB, nÃªn 1024M lÃ  há»£p lÃ½.</p>
<p>Giáº£ sá»­ báº¡n dÃ¹ng PHP-FPM pool <code>www.conf</code>:</p>
<p>VPS: 2 CPU â€“ 8GB RAM:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>pm = dynamic</span></span>
<span class="line"><span>pm.max_children = 20       # thay 15 VPS 2GB RAM</span></span>
<span class="line"><span>pm.start_servers = 4</span></span>
<span class="line"><span>pm.min_spare_servers = 4</span></span>
<span class="line"><span>pm.max_spare_servers = 10  # thay 8 VPS 2GB RAM</span></span>
<span class="line"><span>pm.max_requests = 500      # thay 15 VPS 2GB RAM</span></span></code></pre>
<p>VPS 4GB RAM cÃ³ thá»ƒ tÄƒng <code>pm.max_children</code> lÃªn 25â€“30.</p>
<p>Má»¥c tiÃªu: khÃ´ng Ä‘á»ƒ server swap, nhÆ°ng váº«n Ä‘á»§ worker xá»­ lÃ½ traffic Ä‘á»‰nh.</p>
<h4 id="-step-4--tá»‘i-Æ°u-mariadb-cho-woocommerce">ğŸ”¹ STEP 4 â€“ <strong>Tá»‘i Æ°u MariaDB cho WooCommerce</strong></h4>
<p>Trong file <code>my.cnf</code> (hoáº·c <code>mysqld.cnf</code> hoáº·c  <code>/etc/mysql/mariadb.conf.d/50-server.cnf</code>):</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>innodb_buffer_pool_size=2G       # VPS 2GB â†’ 512M, VPS 4GB â†’ 1G</span></span>
<span class="line"><span>innodb_log_file_size=256M</span></span>
<span class="line"><span>innodb_log_buffer_size=64M</span></span>
<span class="line"><span>innodb_flush_log_at_trx_commit=2</span></span>
<span class="line"><span>innodb_flush_method=O_DIRECT</span></span>
<span class="line"><span>max_connections=100              # VPS 2Gb  â†’ 80</span></span>
<span class="line"><span>tmp_table_size=128M              # VPS 2Gb  â†’ 64M</span></span>
<span class="line"><span>max_heap_table_size=128M         # VPS 2Gb  â†’ 64M</span></span>
<span class="line"><span>query_cache_type = 0</span></span>
<span class="line"><span>query_cache_size = 0</span></span>
<span class="line"><span>table_open_cache=4000</span></span>
<span class="line"><span>thread_cache_size=64</span></span></code></pre>
<ul>
<li>RAM 8GB â†’ <code>innodb_buffer_pool_size=2G</code> lÃ  optimal</li>
<li><code>innodb_flush_log_at_trx_commit=2</code> giÃºp tÄƒng tá»‘c 40%</li>
<li><code>table_open_cache=4000</code> cáº§n thiáº¿t cho WooCommerce product table</li>
</ul>
<p>Restart MySQL/MariaDB sau khi chá»‰nh.</p>
<h4 id="-step-5--object-cache-redis-cho-woocommerce">ğŸ”¹ STEP 5 â€“ Object Cache (Redis) cho WooCommerce</h4>
<p>Náº¿u VPS/Hosting cho phÃ©p cÃ i Redis â†’ gá»£i Ã½:</p>
<ol>
<li>CÃ i Redis server:</li>
</ol>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>apt install redis-server -y</span></span></code></pre>
<p>Chá»‰nh trong <code>/etc/redis/redis.conf</code>:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>maxmemory 256mb         # tuá»³ RAM</span></span>
<span class="line"><span>maxmemory-policy allkeys-lru</span></span></code></pre>
<ol start="2">
<li>WordPress: cÃ i plugin <strong>Redis Object Cache</strong> (by Till KrÃ¼ss)</li>
</ol>
<ul>
<li>Báº­t <code>Enable Object Cache</code></li>
<li>Kiá»ƒm tra status â€œConnectedâ€.</li>
</ul>
<p>Redis giÃºp giáº£m query DB â†’ ráº¥t tá»‘t cho WooCommerce khi cÃ³ nhiá»u sáº£n pháº©m, nhiá»u phiÃªn khÃ¡ch.</p>
<h4 id="-step-7--báº£o-vá»‡-woocommerce--tá»‘i-Æ°u-thÃªm">ğŸ”¹ STEP 7 â€“ Báº£o vá»‡ WooCommerce &#x26; tá»‘i Æ°u thÃªm</h4>
<ol>
<li>Táº¯t review, comment náº¿u khÃ´ng dÃ¹ng
â†’ giáº£m spam, giáº£m query.</li>
<li>Giáº£m sá»‘ sáº£n pháº©m trÃªn má»—i trang / shop page
â†’ 12â€“16 sáº£n pháº©m/trang lÃ  Ä‘áº¹p (thumbnail Ã­t â†’ nháº¹).</li>
<li>Báº­t lazy-load image (qua plugin hoáº·c theme náº¿u Flatsome há»— trá»£).</li>
<li>Giáº£m plugin khÃ´ng cáº§n thiáº¿t
Má»—i plugin = thÃªm PHP + query â†’ Æ°u tiÃªn gá»n.</li>
</ol>
<p><strong>Tá»‘i Æ°u thÃªm Flatsome, báº¡n nÃªn báº­t:</strong></p>
<ul>
<li>Flatsome â†’ Advanced â†’ Lazy Load Enabled</li>
<li>Flatsome â†’ Optimizations â†’ Minify CSS/JS Off (Ä‘Ã£ Ä‘á»ƒ LSCWP lo)</li>
<li>Flatsome â†’ Performance â†’ Smart Loading On</li>
</ul>
<h4 id="-step-8--backup--monitoring">ğŸ”¹ STEP 8 â€“ Backup &#x26; Monitoring</h4>
<ol>
<li>
<p>Backup <a href="/blog/backup-tu-dong-toan-bo-wordpress-stores-len-s3-google-drive-full-guide-tu-hosting-trang-den-production/">(cÃ³ bÃ i hÆ°á»›ng dáº«n xem á»Ÿ Ä‘Ã¢y)</a></p>
<ul>
<li>Daily backup full site (files + DB)</li>
<li>Giá»¯ Ã­t nháº¥t 7â€“14 ngÃ y</li>
<li>LÆ°u á»Ÿ nÆ¡i khÃ¡c VPS (S3, Google Drive, Backblazeâ€¦)</li>
</ul>
</li>
<li>
<p>Monitoring:</p>
<ul>
<li>DÃ¹ng uptime monitor (UptimeRobot / BetterUptime)</li>
<li>Náº¿u VPS cÃ³ CLI: cÃ i <code>htop</code>, <code>iftop</code>, <code>vnstat</code> Ä‘á»ƒ xem CPU/RAM/Network khi bá»‹ táº¥n cÃ´ng.</li>
</ul>
</li>
</ol>
<h4 id="checklist-hoÃ n-háº£o-cho-pháº§n-nÃ y">Checklist hoÃ n háº£o cho pháº§n nÃ y</h4>
<p><strong>Báº¡n Ä‘ang dÃ¹ng:</strong></p>
<ul>
<li>OpenLiteSpeed</li>
<li>LSCWP plugin</li>
<li>Redis</li>
<li>Cloudflare Free (ráº¥t tá»‘i Æ°u)</li>
<li>WooCommerce + Flatsome</li>
<li>VPS 2 CPU + 8GB RAM</li>
<li>MariaDB 10.4 + PHP 8.2</li>
</ul>
<p>ÄÃ¢y lÃ  bá»™ cáº¥u hÃ¬nh siÃªu máº¡nh, náº¿u lÃ m Ä‘áº§y Ä‘á»§ theo checklist mÃ¬nh viáº¿t.</p>
<p><strong>Hiá»‡u nÄƒng báº¡n Ä‘áº¡t Ä‘Æ°á»£c:</strong></p>
<ul>
<li>TTFB &#x3C; 80â€“200ms (USA)</li>
<li>Page load &#x3C; 1.5s</li>
<li>95+/100 Lighthouse Performance</li>
<li>Giáº£m 80% query DB</li>
<li>Giáº£m 60% CPU PHP</li>
<li>Cloudflare Cache HIT tÄƒng 40â€“70%</li>
</ul>
<p><strong>Báº£o máº­t báº¡n Ä‘áº¡t Ä‘Æ°á»£c:</strong></p>
<ul>
<li>Cháº·n bot táº¥n cÃ´ng tá»« Cloudflare â†’ Good</li>
<li>Cháº·n XML-RPC, wp-admin brute-force â†’ Good</li>
<li>Cháº·n upload shell vÃ o uploads â†’ Good</li>
<li>File permission secure â†’ Good</li>
<li>Fail2Ban SSH â†’ Good</li>
</ul>
<p><strong>Website gáº§n nhÆ° bulletproof &#x26; enterprise speed.</strong></p>
<h2 id="-pháº§n-3--aws-s3--cloudfront-cdn-áº£nh">ğŸŸ¦ <strong>PHáº¦N 3 â€“ AWS S3 + CloudFront (CDN áº£nh)</strong></h2>
<p>Giá» mÃ¬nh sáº½ thÃªm lá»›p tá»‘i Æ°u + chá»‘ng lÃ£ng phÃ­ bandwidth + háº¡n cháº¿ bot hÃºt áº£nh cho AWS S3 &#x26; CloudFront.</p>
<h3 id="31-cloudfront--cáº¥u-hÃ¬nh-viewer--cache-cho-áº£nh">3.1. CloudFront â€“ Cáº¥u hÃ¬nh viewer &#x26; cache cho áº£nh</h3>
<p><strong>ğŸ”¹ Chá»‰ cho phÃ©p GET/HEAD, luÃ´n dÃ¹ng HTTPS</strong></p>
<p>VÃ o CloudFront â†’ Distribution cdn.domain.com â†’ Behaviors (Default behavior):</p>
<ul>
<li>Viewer protocol policy: <code>Redirect HTTP to HTTPS</code></li>
<li>Allowed HTTP methods: <code>GET, HEAD</code> (Ä‘á»‘i vá»›i CDN áº£nh lÃ  Ä‘á»§, khÃ´ng cáº§n POST/PUT/DELETE)</li>
</ul>
<p>Äiá»u nÃ y:</p>
<ul>
<li>Giáº£m surface táº¥n cÃ´ng</li>
<li>TrÃ¡nh request ká»³ láº¡ lÃ m tá»‘n tÃ i nguyÃªn</li>
</ul>
<p><strong>ğŸ”¹ Táº¡o Cache Policy riÃªng cho áº£nh (TTL dÃ i â€“ tá»‘i Ä‘a cache)</strong></p>
<p>á» Behavior Ä‘Ã³:</p>
<ul>
<li>Cache policy â†’ chá»n <code>Use a cache policy and origin request policy</code></li>
<li>Táº¡o má»›i Cache policy (vÃ­ dá»¥ Ä‘áº·t tÃªn: <code>ImagesLongTTL</code>):
Gá»£i Ã½ cáº¥u hÃ¬nh:
<ul>
<li>TTL
<ul>
<li>Min TTL: <code>3600</code> (1 giá»)</li>
<li>Default TTL: <code>2592000</code> (30 ngÃ y)</li>
<li>Max TTL: <code>31536000</code> (1 nÄƒm)</li>
</ul>
</li>
<li>Cache key â€“ Headers:
<ul>
<li>None</li>
</ul>
</li>
<li>Cache key â€“ Query strings:
<ul>
<li>Disable (None), trá»« khi báº¡n cÃ³ version áº£nh dáº¡ng query (<code>?v=123</code>)</li>
</ul>
</li>
<li>Cache key â€“ Cookies:
<ul>
<li>None</li>
</ul>
</li>
</ul>
</li>
</ul>
<p>Ã tÆ°á»Ÿng:</p>
<ul>
<li>CloudFront sáº½ cache áº£nh theo URL lÃ  Ä‘á»§.</li>
<li>KhÃ´ng forward cookie / query linh tinh â†’ tÄƒng cache hit â†’ giáº£m hit S3 â†’ tiáº¿t kiá»‡m tiá»n.</li>
</ul>
<p><strong>ğŸ”¹ Origin request policy â€“ khÃ´ng gá»­i thá»© khÃ´ng cáº§n thiáº¿t vá» S3</strong></p>
<p>Trong Behavior:</p>
<ul>
<li>Chá»n Origin request policy riÃªng (vd: <code>S3Minimal</code>)
Gá»£i Ã½:
<ul>
<li>Headers to origin:
<ul>
<li><em>Only required</em>: Host, User-Agent náº¿u cáº§n log; cÃ²n láº¡i cÃ ng Ã­t cÃ ng tá»‘t.</li>
</ul>
</li>
<li>Query strings: None (trá»« khi báº¡n dÃ¹ng query versioning)</li>
<li>Cookies: None</li>
</ul>
</li>
</ul>
<p><strong>Káº¿t quáº£:</strong></p>
<ul>
<li>1 request CloudFront â†’ 90% serve tá»« cache.</li>
<li>10% cÃ²n láº¡i Ä‘i S3 nhÆ°ng nháº¹ &#x26; sáº¡ch.</li>
</ul>
<h3 id="32-s3-bucket---khÃ³a-cháº·t-bucket--giáº£m-rá»§i-ro">3.2. S3 Bucket - KhÃ³a cháº·t bucket &#x26; giáº£m rá»§i ro</h3>
<ul>
<li>Block public access</li>
<li>Private bucket</li>
<li>Chá»‰ cho phÃ©p CloudFront OAI/OAC Ä‘á»c</li>
</ul>
<p>Bucket policy chuáº©n:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>{</span></span>
<span class="line"><span>  "Version": "2012-10-17",</span></span>
<span class="line"><span>  "Statement": [</span></span>
<span class="line"><span>    {</span></span>
<span class="line"><span>      "Sid": "AllowCloudFrontReadObjects",</span></span>
<span class="line"><span>      "Effect": "Allow",</span></span>
<span class="line"><span>      "Principal": {</span></span>
<span class="line"><span>        "AWS": "arn:aws:iam::cloudfront:user/CloudFront Origin Access Identity XXXXXXXXX"</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      "Action": "s3:GetObject",</span></span>
<span class="line"><span>      "Resource": "arn:aws:s3:::your-bucket-name/*"</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span>  ]</span></span>
<span class="line"><span>}</span></span></code></pre>
<p><strong>Lifecycle rule â€“ tá»‘i Æ°u chi phÃ­ lÆ°u trá»¯</strong></p>
<p>Náº¿u báº¡n cÃ³ áº£nh cÅ© khÃ´ng Ä‘á»•i, cÃ³ thá»ƒ:</p>
<ul>
<li>Sau 90 ngÃ y â†’ chuyá»ƒn sang S3 Standard-IA</li>
<li>Sau 365 ngÃ y â†’ chuyá»ƒn sang Glacier Instant Retrieval (tuá»³ chiáº¿n lÆ°á»£c backup)</li>
</ul>
<p>VÃ o S3 â†’ bucket â†’ Management â†’ Lifecycle rules
â†’ Táº¡o rule dá»±a trÃªn prefix (vd: <code>uploads/2023/</code>)</p>
<p>Äiá»u nÃ y khÃ´ng pháº£i báº£o máº­t, nhÆ°ng giáº£m tiá»n S3.</p>
<h3 id="33-hotlink-protection-optional">3.3. <strong>Hotlink protection (optional)</strong></h3>
<p>Hotlink protection &#x26; chá»‘ng site khÃ¡c xÃ i kÃ© áº£nh. Hiá»‡n táº¡i:</p>
<ul>
<li>S3 private â†’ chá»‰ CloudFront Ä‘Æ°á»£c Ä‘á»c</li>
<li>NhÆ°ng báº¥t ká»³ ai cÃ³ URL <code>https://cdn.domain.com/...</code> váº«n embed Ä‘Æ°á»£c áº£nh vÃ o site cá»§a há» â†’ tá»‘n CloudFront bandwidth.</li>
</ul>
<p>Náº¿u báº¡n muá»‘n háº¡n cháº¿ hotlink, cÃ³ 2 má»©c:</p>
<p>DÃ¹ng CloudFront Function:</p>
<ul>
<li>Check <code>Referer</code></li>
<li>Náº¿u khÃ´ng pháº£i domain báº¡n â†’ tráº£ 403</li>
</ul>
<p>Ok, lÃ m tá»«ng bÆ°á»›c cho dá»… theo dÃµi nhÃ©. MÃ¬nh sáº½ hÆ°á»›ng dáº«n:</p>
<ol>
<li>Táº¡o CloudFront Function <code>anti_hotlink_wp_uploads_safe</code></li>
<li>DÃ¡n full code Safe Mode</li>
<li>Publish version</li>
<li>Gáº¯n vÃ o Viewer Request cá»§a behavior <code>/wp-content/uploads/*</code></li>
</ol>
<h4 id="-step-1--táº¡o-cloudfront-function-má»›i">ğŸ”¹ STEP 1 â€“ Táº¡o CloudFront Function má»›i</h4>
<ol>
<li>VÃ o AWS Console â†’ CloudFront</li>
<li>Menu bÃªn trÃ¡i â†’ Functions</li>
<li>Báº¥m Create function</li>
</ol>
<p>Trong mÃ n hÃ¬nh giá»‘ng hÃ¬nh báº¡n gá»­i:</p>
<ul>
<li><strong>Name:</strong> <code>anti_hotlink_wp_uploads_safe</code></li>
<li>**Description (optional):**Anti hotlink for WordPress uploads (safe mode)</li>
<li><strong>Runtime:</strong> chá»ncloudfront-js-2.0</li>
</ul>
<p>Báº¥m Create function.</p>
<h4 id="-step-2--dÃ¡n-code-safe-mode-vÃ o-function">ğŸ”¹ STEP 2 â€“ DÃ¡n code Safe Mode vÃ o function</h4>
<p>Sau khi táº¡o xong, báº¡n sáº½ Ä‘Æ°á»£c Ä‘Æ°a vÃ o trang chi tiáº¿t function:</p>
<ol>
<li>Tab Code (máº·c Ä‘á»‹nh).</li>
<li>Trong Ã´ editor sáº½ cÃ³ code máº«u <code>function handler(event) { ... }</code>.</li>
</ol>
<p>XoÃ¡ háº¿t vÃ  dÃ¡n toÃ n bá»™ Ä‘oáº¡n code nÃ y:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>function isGoodBot(ua) {</span></span>
<span class="line"><span>  if (!ua) return false;</span></span>
<span class="line"><span>  ua = ua.toLowerCase();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Bot SEO + Social + Preview phá»• biáº¿n</span></span>
<span class="line"><span>  var allowBots = [</span></span>
<span class="line"><span>    "googlebot",</span></span>
<span class="line"><span>    "bingbot",</span></span>
<span class="line"><span>    "yandexbot",</span></span>
<span class="line"><span>    "duckduckbot",</span></span>
<span class="line"><span>    "baiduspider",</span></span>
<span class="line"><span>    "applebot",</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Social &#x26; chat preview</span></span>
<span class="line"><span>    "facebookexternalhit",</span></span>
<span class="line"><span>    "twitterbot",</span></span>
<span class="line"><span>    "linkedinbot",</span></span>
<span class="line"><span>    "slackbot",</span></span>
<span class="line"><span>    "discordbot",</span></span>
<span class="line"><span>    "whatsapp",</span></span>
<span class="line"><span>    "telegrambot",</span></span>
<span class="line"><span>    "pinterestbot",</span></span>
<span class="line"><span>    "vkshare",</span></span>
<span class="line"><span>    "embedly",</span></span>
<span class="line"><span>    "quora link preview",</span></span>
<span class="line"><span>    "redditbot",</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Tool cá»§a Google vÃ  validator há»£p lá»‡</span></span>
<span class="line"><span>    "google-structured-data-testing-tool",</span></span>
<span class="line"><span>    "google-inspectiontool"</span></span>
<span class="line"><span>  ];</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for (var i = 0; i &#x3C; allowBots.length; i++) {</span></span>
<span class="line"><span>    if (ua.indexOf(allowBots[i]) !== -1) return true;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return false;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function looksLikeBrowser(ua) {</span></span>
<span class="line"><span>  if (!ua) return false;</span></span>
<span class="line"><span>  ua = ua.toLowerCase();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Nháº­n diá»‡n browser tháº­t (Chrome, Safari, Firefox, Edgeâ€¦)</span></span>
<span class="line"><span>  return (</span></span>
<span class="line"><span>    ua.indexOf("mozilla") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("chrome") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("safari") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("firefox") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("edg") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("opera") !== -1 ||</span></span>
<span class="line"><span>    ua.indexOf("opr/") !== -1</span></span>
<span class="line"><span>  );</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function isObviousScript(ua) {</span></span>
<span class="line"><span>  if (!ua) return false;</span></span>
<span class="line"><span>  ua = ua.toLowerCase();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // CÃ¡c tool/script hay dÃ¹ng Ä‘á»ƒ cÃ o áº£nh, khÃ´ng pháº£i browser</span></span>
<span class="line"><span>  var badList = [</span></span>
<span class="line"><span>    "curl",</span></span>
<span class="line"><span>    "wget",</span></span>
<span class="line"><span>    "python-requests",</span></span>
<span class="line"><span>    "python-urllib",</span></span>
<span class="line"><span>    "httpclient",</span></span>
<span class="line"><span>    "java/",</span></span>
<span class="line"><span>    "libwww-perl",</span></span>
<span class="line"><span>    "go-http-client",</span></span>
<span class="line"><span>    "okhttp",</span></span>
<span class="line"><span>    "node-fetch",</span></span>
<span class="line"><span>    "php/",</span></span>
<span class="line"><span>    "perl",</span></span>
<span class="line"><span>    "ruby",</span></span>
<span class="line"><span>    "powershell",</span></span>
<span class="line"><span>    "httpget",</span></span>
<span class="line"><span>    "httpunit",</span></span>
<span class="line"><span>    "masscan"</span></span>
<span class="line"><span>  ];</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  for (var i = 0; i &#x3C; badList.length; i++) {</span></span>
<span class="line"><span>    if (ua.indexOf(badList[i]) !== -1) return true;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span>  return false;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function getRootDomain(hostname) {</span></span>
<span class="line"><span>  if (!hostname) return "";</span></span>
<span class="line"><span>  hostname = hostname.toLowerCase();</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // XÃ³a port náº¿u cÃ³ (vd: example.com:8080)</span></span>
<span class="line"><span>  var colonIndex = hostname.indexOf(":");</span></span>
<span class="line"><span>  if (colonIndex !== -1) {</span></span>
<span class="line"><span>    hostname = hostname.substring(0, colonIndex);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  var parts = hostname.split(".");</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Náº¿u chá»‰ cÃ³ 1â€“2 pháº§n (localhost, example.com) thÃ¬ tráº£ luÃ´n</span></span>
<span class="line"><span>  if (parts.length &#x3C;= 2) {</span></span>
<span class="line"><span>    return hostname;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Láº¥y 2 pháº§n cuá»‘i: domain + TLD â†’ vÃ­ dá»¥: cdn.domain.com â†’ domain.com</span></span>
<span class="line"><span>  // (LÆ°u Ã½: vá»›i domain kiá»ƒu .co.uk thÃ¬ cáº§n logic phá»©c táº¡p hÆ¡n, nhÆ°ng cho .com, .net, .org, .ioâ€¦ lÃ  á»•n)</span></span>
<span class="line"><span>  return parts[parts.length - 2] + "." + parts[parts.length - 1];</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function getHostFromUrl(url) {</span></span>
<span class="line"><span>  if (!url) return "";</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  var host = url;</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Bá» schema: http://, https://</span></span>
<span class="line"><span>  var schemeIndex = host.indexOf("://");</span></span>
<span class="line"><span>  if (schemeIndex !== -1) {</span></span>
<span class="line"><span>    host = host.substring(schemeIndex + 3);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // Cáº¯t pháº§n path: /abc/xyz</span></span>
<span class="line"><span>  var slashIndex = host.indexOf("/");</span></span>
<span class="line"><span>  if (slashIndex !== -1) {</span></span>
<span class="line"><span>    host = host.substring(0, slashIndex);</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  return host;</span></span>
<span class="line"><span>}</span></span>
<span class="line"><span></span></span>
<span class="line"><span>function handler(event) {</span></span>
<span class="line"><span>  var request = event.request;</span></span>
<span class="line"><span>  var headers = request.headers || {};</span></span>
<span class="line"><span>  var ua = (headers["user-agent"] &#x26;&#x26; headers["user-agent"].value) || "";</span></span>
<span class="line"><span>  var hostHeader = (headers.host &#x26;&#x26; headers.host.value) || "";</span></span>
<span class="line"><span>  var cdnRoot = getRootDomain(hostHeader);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // ===== 0. Safe mode: chá»‰ Ã¡p dá»¥ng cho áº£nh (optional, phÃ²ng trÆ°á»ng há»£p behavior match rá»™ng) =====</span></span>
<span class="line"><span>  var uri = request.uri || "";</span></span>
<span class="line"><span>  var isImagePath =</span></span>
<span class="line"><span>    uri.indexOf("/wp-content/uploads/") !== -1 &#x26;&#x26;</span></span>
<span class="line"><span>    (uri.indexOf(".jpg") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".jpeg") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".png") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".gif") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".webp") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".avif") !== -1 ||</span></span>
<span class="line"><span>      uri.indexOf(".svg") !== -1);</span></span>
<span class="line"><span>  if (!isImagePath) {</span></span>
<span class="line"><span>    // KhÃ´ng pháº£i áº£nh trong uploads â†’ khÃ´ng Ä‘á»¥ng vÃ o</span></span>
<span class="line"><span>    return request;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // ===== 1. Allow bot tá»‘t (SEO + social + preview) =====</span></span>
<span class="line"><span>  if (isGoodBot(ua)) {</span></span>
<span class="line"><span>    return request;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // ===== 2. Block tool/script cÃ o áº£nh rÃµ rÃ ng, khÃ´ng pháº£i browser, khÃ´ng pháº£i good bot =====</span></span>
<span class="line"><span>  if (isObviousScript(ua)) {</span></span>
<span class="line"><span>    return {</span></span>
<span class="line"><span>      statusCode: 403,</span></span>
<span class="line"><span>      statusDescription: "Forbidden",</span></span>
<span class="line"><span>      headers: {</span></span>
<span class="line"><span>        "content-type": { value: "text/plain" }</span></span>
<span class="line"><span>      },</span></span>
<span class="line"><span>      body: "Forbidden"</span></span>
<span class="line"><span>    };</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // ===== 3. Náº¿u lÃ  browser tháº­t â†’ kiá»ƒm tra Referer Ä‘á»ƒ cháº·n hotlink =====</span></span>
<span class="line"><span>  if (looksLikeBrowser(ua)) {</span></span>
<span class="line"><span>    var referer = (headers.referer &#x26;&#x26; headers.referer.value) || "";</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Safe mode: khÃ´ng cÃ³ Referer -> CHO QUA</span></span>
<span class="line"><span>    if (!referer) {</span></span>
<span class="line"><span>      return request;</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    var refHost = getHostFromUrl(referer);</span></span>
<span class="line"><span>    var refRoot = getRootDomain(refHost);</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // Náº¿u root khÃ¡c â†’ hotlink tá»« domain láº¡ -> block</span></span>
<span class="line"><span>    if (refRoot &#x26;&#x26; refRoot !== cdnRoot) {</span></span>
<span class="line"><span>      return {</span></span>
<span class="line"><span>        statusCode: 403,</span></span>
<span class="line"><span>        statusDescription: "Forbidden",</span></span>
<span class="line"><span>        headers: {</span></span>
<span class="line"><span>          "content-type": { value: "text/plain" }</span></span>
<span class="line"><span>        },</span></span>
<span class="line"><span>        body: "Hotlink not allowed"</span></span>
<span class="line"><span>      };</span></span>
<span class="line"><span>    }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>    // CÃ¹ng root â†’ lÃ  site cá»§a báº¡n hoáº·c subdomain cá»§a báº¡n â†’ cho qua</span></span>
<span class="line"><span>    return request;</span></span>
<span class="line"><span>  }</span></span>
<span class="line"><span></span></span>
<span class="line"><span>  // ===== 4. CÃ¡c request cÃ²n láº¡i (app, RSS Ä‘á»™c láº¡, client Ä‘áº·c biá»‡t, no UAâ€¦) -> Safe mode: cho qua =====</span></span>
<span class="line"><span>  return request;</span></span>
<span class="line"><span>}</span></span></code></pre>
<p>Xong, báº¥m <strong>Save changes</strong>.</p>
<h4 id="-step-3--publish-function">ğŸ”¹ STEP 3 â€“ Publish function</h4>
<ol>
<li>Trong trang function, gÃ³c trÃªn bÃªn pháº£i â†’ báº¥m Publish.</li>
<li>Nháº­p mÃ´ táº£ version, vÃ­ dá»¥:v1 initial safe anti hotlink</li>
<li>XÃ¡c nháº­n Publish.</li>
</ol>
<p>Sau khi publish, function sáº½ cÃ³:</p>
<ul>
<li><code>Development</code> version (Ä‘á»ƒ sá»­a code)</li>
<li><code>Live</code> version (published) dÃ¹ng Ä‘Æ°á»£c trong Distribution.</li>
</ul>
<h4 id="-step-4--gáº¯n-function-vÃ o-behavior">ğŸ”¹ STEP 4 â€“ Gáº¯n function vÃ o Behavior</h4>
<p>Giá» chuyá»ƒn sang distribution CDN:</p>
<ol>
<li>VÃ o CloudFront â†’ Distributions.</li>
<li>Chá»n distribution Ä‘ang dÃ¹ng cho <code>cdn.domain.com</code>.</li>
<li>Tab Behaviors.</li>
</ol>
<ul>
<li>Náº¿u chÆ°a cÃ³ behavior riÃªng:
<ul>
<li>Báº¥m Create behavior.</li>
<li>Path pattern:/wp-content/uploads/*</li>
<li>Chá»n Ä‘Ãºng Origin trá» Ä‘áº¿n S3 chá»©a file WordPress (giá»‘ng origin behavior <code>*</code> náº¿u báº¡n dÃ¹ng chung).</li>
<li>CÃ¡c pháº§n Cache policy / Origin request policy giá»¯ giá»‘ng behavior hiá»‡n táº¡i dÃ¹ng cho static file lÃ  Ä‘Æ°á»£c.</li>
</ul>
</li>
<li>Náº¿u Ä‘Ã£ cÃ³ behavior <code>/wp-content/uploads/*</code> rá»“i:
<ul>
<li>Chá»n nÃ³ â†’ báº¥m Edit.</li>
</ul>
</li>
</ul>
<p>ThÃªm function vÃ o Viewer Request. Trong pháº§n cáº¥u hÃ¬nh behavior:</p>
<ol>
<li>
<p>KÃ©o xuá»‘ng má»¥c Function associations.</p>
</li>
<li>
<p>á» dÃ²ng Viewer request:</p>
<ul>
<li>Function type: CloudFront Function</li>
<li>Function: chá»n <code>anti_hotlink_wp_uploads_safe</code></li>
</ul>
</li>
<li>
<p>Báº¥m Save changes.</p>
</li>
</ol>
<p>CloudFront sáº½ deploy config má»›i (máº¥t vÃ i phÃºt propagate toÃ n bá»™ edge).</p>
<h4 id="-step-5--kiá»ƒm-tra-nhanh">ğŸ”¹ STEP 5 â€“ Kiá»ƒm tra nhanh</h4>
<p>Sau khi propagate. Má»Ÿ 1 áº£nh tá»« site cá»§a báº¡n, vÃ­ dá»¥:</p>
<p><code>https://cdn.domain.com/wp-content/uploads/2025/12/my-product.jpg</code></p>
<p>â€¦trong tab bÃ¬nh thÆ°á»ng cá»§a browser â†’ áº£nh pháº£i load OK.</p>
<p>Thá»­ copy URL áº£nh Ä‘Ã³, dÃ¡n vÃ o HTML cá»§a 1 domain khÃ¡c (hoáº·c táº¡m test báº±ng cÃ¡ch gá»­i request vá»›i Referer giáº£ báº±ng</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span># 1) Giáº£ láº­p browser tháº­t + khÃ´ng Referer -> EXPECT: 200</span></span>
<span class="line"><span>curl -I \</span></span>
<span class="line"><span>  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0" \</span></span>
<span class="line"><span>  "https://cdn.domain.com/wp-content/uploads/20240610060342/2024-Matching-Family-Trip-Magic-Kingdom-Shirts-I-m-Gonna-Ride-Til-I-Can-t-No-More-T-shirt-0.jpg"</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 2) Giáº£ láº­p browser tháº­t + Referer cÃ¹ng domain -> EXPECT: 200</span></span>
<span class="line"><span>curl -I \</span></span>
<span class="line"><span>  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0" \</span></span>
<span class="line"><span>  -H "Referer: https://cdn.domain.com/some-page" \</span></span>
<span class="line"><span>  "https://cdn.domain.com/wp-content/uploads/20240610060342/2024-Matching-Family-Trip-Magic-Kingdom-Shirts-I-m-Gonna-Ride-Til-I-Can-t-No-More-T-shirt-0.jpg"</span></span>
<span class="line"><span></span></span>
<span class="line"><span># 3) Giáº£ láº­p browser tháº­t + Referer domain khÃ¡c -> EXPECT: 403</span></span>
<span class="line"><span>curl -I \</span></span>
<span class="line"><span>  -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) Chrome/120.0" \</span></span>
<span class="line"><span>  -H "Referer: https://evil-competitor.com/page" \</span></span>
<span class="line"><span>  "https://cdn.domain.com/wp-content/uploads/20240610060342/2024-Matching-Family-Trip-Magic-Kingdom-Shirts-I-m-Gonna-Ride-Til-I-Can-t-No-More-T-shirt-0.jpg"</span></span></code></pre>
<p>Náº¿u 3 case nÃ y ra Ä‘Ãºng nhÆ° mÃ¬nh ghi thÃ¬:</p>
<ul>
<li>Function Ä‘ang cháº¡y y nhÆ° thiáº¿t káº¿.</li>
<li>Chá»‰ script/tool nhÆ° curl/wget/python má»›i bá»‹ block.</li>
<li>User tháº­t + bot SEO + social preview Ä‘á»u OK.</li>
</ul>
<p><strong>CloudFront Function <em>khÃ¡c</em> Lambda@Edge nhÆ° tháº¿ nÃ o?</strong></p>




















<table><thead><tr><th>Loáº¡i</th><th>TÃ­nh phÃ­ khi?</th><th>Ghi chÃº</th></tr></thead><tbody><tr><td><strong>CloudFront Function</strong></td><td>Khi INVOCATION</td><td>Ráº¥t ráº» (micro billing)</td></tr><tr><td><strong>Lambda@Edge</strong></td><td>Khi deploy + propagate + invocation + duration</td><td>Phá»©c táº¡p hÆ¡n &#x26; Ä‘áº¯t hÆ¡n</td></tr></tbody></table>
<p>Báº¡n Ä‘ang dÃ¹ng CloudFront Function â†’ ráº» vÃ  chá»‰ tÃ­nh tiá»n theo sá»‘ láº§n cháº¡y.</p>
<p><strong>GiÃ¡ tiá»n cá»¥ thá»ƒ cá»§a CloudFront Function</strong></p>
<p>CloudFront Function chá»‰ tÃ­nh tiá»n khi cÃ³ <em>invocation</em> (kÃ­ch hoáº¡t). Invocation xáº£y ra khi:</p>
<ul>
<li>Báº¡n gáº¯n function vÃ o má»™t Behavior</li>
<li>Behavior Ä‘Ã³ cÃ³ request Ä‘i qua</li>
<li>VÃ  Event Type Ä‘Ãºng (Viewer Request / Viewer Response)</li>
</ul>
<blockquote>
<p>ğŸ“Œ Chi phÃ­ = sá»‘ láº§n request CloudFront <em>vÃ o behavior cÃ³ gáº¯n function</em></p>
</blockquote>
<p>KhÃ´ng pháº£i sá»‘ láº§n ngÆ°á»i dÃ¹ng gá»i vÃ o website. MÃ¬nh khÃ´ng quote con sá»‘ tuyá»‡t Ä‘á»‘i vÃ¬ AWS cÃ³ thá»ƒ thay Ä‘á»•i, nhÆ°ng nÃ³ ráº¥t ráº»:</p>
<ul>
<li>Vá»›i vÃ i triá»‡u request/thÃ¡ng: chá»‰ tá»‘n vÃ i cent â€“ vÃ i USD</li>
<li>So vá»›i chi phÃ­ CloudFront Data Transfer â†’ cloudfront function gáº§n nhÆ° free</li>
<li>Chi phÃ­ nhá» hÆ¡n ráº¥t nhiá»u so vá»›i S3 hoáº·c bÄƒng thÃ´ng CloudFront</li>
</ul>
<p><strong>VÃ­ dá»¥ thá»±c táº¿</strong></p>
<p>Náº¿u báº¡n cÃ³:</p>
<ul>
<li>500.000 lÆ°á»£t xem áº£nh <code>/wp-content/uploads/*</code> má»—i ngÃ y
â†’ 15 triá»‡u request/thÃ¡ng
â†’ Function cháº¡y 15 triá»‡u láº§n
â†’ Chi phÃ­ chá»‰ vÃ i USD (ráº¥t nhá»)</li>
</ul>
<p><strong>Náº¿u báº¡n cÃ³:</strong></p>
<ul>
<li>0 request â†’ 0 tiá»n</li>
<li>Behavior default <em>khÃ´ng gáº¯n function</em> â†’ 0 tiá»n</li>
</ul>
<h2 id="4-lifecycle-s3-náº¿u-muá»‘n-tiáº¿t-kiá»‡m-storage">4. <strong>Lifecycle S3 (náº¿u muá»‘n tiáº¿t kiá»‡m storage)</strong></h2>
<p>Náº¿u website cá»§a báº¡n chá»‰ táº§m 5.000 sáº£n pháº©m, má»—i sáº£n pháº©m 3â€“5 áº£nh <em>(cÃ³ nhiá»u size thumbnail, medium, large, â€¦)</em>, <a href="/blog/chien-luoc-tiet-kiem-chi-phi-toi-uu-amazon-s3-storage-class-cho-backup-website/">Lifecycle chuyá»ƒn Standard â†’ IA â†’ Glacier IR</a> thÆ°á»ng KHÃ”NG Ä‘Ã¡ng lÃ m, trá»« khi dung lÆ°á»£ng áº£nh lÃªn Ä‘áº¿n hÃ ng trÄƒm GB / TB vÃ  Ä‘a sá»‘ sáº£n pháº©m Ä‘Ã£ nghá»‰ hÆ°u.</p>
<h3 id="41-hiá»ƒu-Ä‘Ãºng-bÃ i-toÃ¡n-tiá»n-báº¡c-má»™t-chÃºt">4.1. Hiá»ƒu Ä‘Ãºng bÃ i toÃ¡n tiá»n báº¡c má»™t chÃºt</h3>
<p>GiÃ¡ S3 (us-east-1, lÃ m trÃ²n):</p>
<ul>
<li>Standard: ~0.023$/GB/thÃ¡ng</li>
<li>Standard-IA: ~0.0125$/GB/thÃ¡ng</li>
<li>Glacier Instant Retrieval: ~0.004$/GB/thÃ¡ng</li>
</ul>
<p>Giáº£ sá»­:</p>
<ul>
<li>Báº¡n cÃ³ 5.000 sáº£n pháº©m</li>
<li>Má»—i sáº£n pháº©m 3â€“5 áº£nh * nhiá»u size (thumbnail, medium, large, â€¦)</li>
<li>Tá»•ng dung lÆ°á»£ng áº£nh thá»±c táº¿ thÆ°á»ng rÆ¡i khoáº£ng 20â€“80GB (Ä‘a sá»‘ site WooCommerce cá»¡ nÃ y)</li>
</ul>
<p>Tiá»n S3 Standard:</p>
<ul>
<li>50GB * 0.023 â‰ˆ 1.15$ / thÃ¡ng</li>
<li>100GB * 0.023 â‰ˆ 2.3$ / thÃ¡ng</li>
</ul>
<p>NhÆ° váº­y pháº§n lá»›n chi phÃ­ AWS cá»§a báº¡n khÃ´ng náº±m á»Ÿ S3 storage, mÃ  á»Ÿ:</p>
<ul>
<li>CloudFront bandwidth (truyá»n táº£i tá»›i khÃ¡ch)</li>
<li>Request dáº¡ng GET/HEAD</li>
<li>CÃ³ thá»ƒ lÃ  log, Lambda, â€¦ (náº¿u cÃ³ dÃ¹ng)</li>
</ul>
<p>Tiáº¿t kiá»‡m tá»« Standard â†’ IA/Glacier IR trÃªn vÃ i chá»¥c GB áº£nh chá»‰ giÃºp giáº£m vÃ i chá»¥c ngÃ n â€“ vÃ i Ä‘Ã´ má»—i thÃ¡ng, nhÆ°ng Ä‘á»•i láº¡i:</p>
<ul>
<li>Cáº¥u hÃ¬nh phá»©c táº¡p hÆ¡n</li>
<li>Nhiá»u thá»© cáº§n theo dÃµi hÆ¡n</li>
<li>Dá»… lá»¡ tay lÃ m áº£nh hÆ°á»Ÿng tá»›i hoáº¡t Ä‘á»™ng site</li>
</ul>
<p>Vá»›i bÃ i toÃ¡n website store cá»§a báº¡n cÃ¡c sáº£n pháº©m 2021 váº«n bÃ¡n tá»‘t 2025 thÃ¬ áº£nh cá»§a chÃºng váº«n Ä‘Æ°á»£c xem thÆ°á»ng xuyÃªn, khÃ´ng pháº£i Ã­t truy cáº­p. Trong khi Ä‘Ã³, cÃ¡c storage class IA / Glacier IR Ä‘Æ°á»£c thiáº¿t káº¿ cho object tháº­t sá»± Ã­t Ä‘Æ°á»£c Ä‘á»c.</p>
<p>Náº¿u áº£nh Ä‘Æ°á»£c xem Ä‘á»u Ä‘á»u (dÃ¹ khÃ´ng nhiá»u nhÆ° áº£nh má»›i), thÃ¬:</p>
<ul>
<li>Tiáº¿t kiá»‡m Ä‘Æ°á»£c ráº¥t Ã­t á»Ÿ pháº§n storage</li>
<li>NhÆ°ng pháº£i tráº£ phÃ­ retrieval &#x26; request cao hÆ¡n (dÃ¹ CloudFront Ä‘Ã£ giáº£m Ä‘Ã¡ng ká»ƒ)</li>
<li>MÃ  báº¡n cÃ²n thÃªm rá»§i ro nháº§m láº«n cáº¥u hÃ¬nh</li>
</ul>
<h3 id="42-lifecycle-cÃ³-lá»£i-nháº¥t-khi-nÃ o">4.2. Lifecycle cÃ³ lá»£i nháº¥t khi nÃ o?</h3>
<p>Lifecycle <code>Standard</code> â†’ <code>IA</code> â†’ <code>Glacier IR</code> chá»‰ tháº­t sá»± Ä‘Ã¡ng:</p>
<ol>
<li>
<p><strong>Dung lÆ°á»£ng S3 ráº¥t lá»›n</strong></p>
<ul>
<li>VÃ­ dá»¥ > 500GB â€“ 1TB chá»‰ toÃ n media cÅ©</li>
<li>LÃºc Ä‘Ã³ má»—i thÃ¡ng Standard â‰ˆ 11.5â€“23$; IA/Glacier IR cÃ³ thá»ƒ tiáº¿t kiá»‡m >10$/thÃ¡ng.</li>
</ul>
</li>
<li>
<p><strong>Pháº§n lá»›n object thá»±c sá»± khÃ´ng cÃ²n háº§u nhÆ° ai xem</strong></p>
<ul>
<li>áº¢nh sáº£n pháº©m Ä‘Ã£ ngÆ°ng bÃ¡n</li>
<li>áº¢nh backup ná»™i bá»™, log, snapshot,â€¦</li>
<li>Media cÅ© cá»§a blog/landing page Ä‘Ã£ khÃ´ng náº±m trong sitemap ná»¯a</li>
</ul>
</li>
<li>
<p><strong>Báº¡n cÃ³ sá»‘ liá»‡u thá»±c táº¿ (S3 Storage Class Analysis / Access Logs) chá»©ng minh:</strong></p>
<ul>
<li>ÄÃ¡m object nÃ y 6â€“12 thÃ¡ng khÃ´ng ai Ä‘á»¥ng tá»›i.</li>
</ul>
</li>
</ol>
<h3 id="43-triá»ƒn-khai-má»¥c-tiÃªu-cÃ¡ch-lÃ m">4.3. Triá»ƒn khai má»¥c tiÃªu cÃ¡ch lÃ m</h3>
<p>KHÃ”NG táº¡o rule kiá»ƒu:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Filter: Entire bucket</span></span></code></pre>
<p>Ráº¥t nguy hiá»ƒm vÃ¬ nÃ³ cÃ³ thá»ƒ Ã¡p dá»¥ng cho cáº£ file quan trá»ng nhÆ°:</p>
<ul>
<li>JS, CSS (náº¿u báº¡n dÃ¹ng S3 Ä‘á»ƒ chá»©a assets)</li>
<li>file cáº¥u hÃ¬nh</li>
<li>file táº¡m</li>
<li>plugin uploads</li>
</ul>
<p>(CÃ¡c file nÃ y KHÃ”NG Ä‘Æ°á»£c chuyá»ƒn sang IA/Glacier)</p>
<p>Thiáº¿t káº¿ cáº¥u trÃºc Lifecycle AN TOÃ€N cho WooCommerce. TUYá»†T Äá»I KHÃ”NG táº¡o luáº­t cho toÃ n bá»™ bucket</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Prefix: wp-content/uploads/2023/</span></span>
<span class="line"><span>â†’ 0 days â†’ Standard (máº·c Ä‘á»‹nh upload)</span></span>
<span class="line"><span>â†’ 90 days â†’ Standard-IA</span></span>
<span class="line"><span>â†’ 365 days â†’ Glacier Instant Retrieval</span></span></code></pre>
<p>VÃ­ dá»¥ Prefix:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>wp-content/uploads/2021/</span></span>
<span class="line"><span>wp-content/uploads/2022/</span></span>
<span class="line"><span>wp-content/uploads/2023/</span></span>
<span class="line"><span>wp-content/uploads/2024/</span></span></code></pre>
<ul>
<li>áº¢nh nÄƒm 2025 (Ä‘ang hot) khÃ´ng bá»‹ tÃ¡c Ä‘á»™ng.</li>
<li>Báº¡n hoÃ n toÃ n kiá»ƒm soÃ¡t nÄƒm nÃ o chuyá»ƒn cold storage.</li>
</ul>
<p>ÄÃ¢y lÃ  chiáº¿n lÆ°á»£c Ä‘Æ°á»£c khuyáº¿n nghá»‹ máº¡nh nháº¥t dÃ nh cho site WordPress + S3.</p>
<h4 id="standard-ia">Standard-IA</h4>
<p><strong>Standard-IA (Infrequent Access)</strong> lÃ  tier dÃ¹ng Ä‘á»ƒ lÆ°u file cÅ©/Ã­t truy cáº­p.
CloudFront phá»¥c vá»¥ 90â€“99% áº£nh tá»« edge cache â†’ khÃ´ng Ä‘Ã¡nh vÃ o S3.
DÃ¹ áº£nh Ä‘Ã£ chuyá»ƒn sang IA, CloudFront váº«n:</p>
<ul>
<li>Load áº£nh</li>
<li>Cache láº¡i</li>
<li>Phá»¥c vá»¥ cuá»‘i cÃ¹ng cho user</li>
</ul>
<p>User khÃ´ng biáº¿t áº£nh Ä‘áº¿n tá»« tier nÃ o.</p>
<p>ğŸ”¹<strong>Price impact</strong></p>
<ul>
<li>Storage ráº» hÆ¡n ~40% so vá»›i Standard</li>
<li>Tuy nhiÃªn má»—i request S3 sáº½ Ä‘áº¯t hÆ¡n má»™t chÃºt. NhÆ°ng vÃ¬ CloudFront Ä‘Ã£ che S3 â†’ request vÃ o S3 cá»±c tháº¥p â†’ báº¡n khÃ´ng bá»‹ tá»‘n thÃªm nhiá»u.</li>
</ul>
<p>ğŸ”¹<strong>KhÃ´ng cÃ³ delay</strong></p>
<p>KhÃ¡c vá»›i Glacier, Standard-IA khÃ´ng cÃ³ delay retrieval.</p>
<p><strong>Káº¿t luáº­n</strong>: Báº¡n thoáº£i mÃ¡i chuyá»ƒn áº£nh cÅ© â†’ IA.</p>
<h4 id="glacier-instant-retrieval">Glacier Instant Retrieval</h4>
<p><strong>Glacier IR (Instant Retrieval)</strong> = retrieval thá»i gian &#x3C; 1 giÃ¢y (instant).
KhÃ¡c vá»›i Glacier Flexible/Deep Archive:</p>
<ul>
<li>KHÃ”NG delay</li>
<li>KHÃ”NG cáº§n restore</li>
<li>KHÃ”NG lá»—i 404</li>
<li>CloudFront váº«n fetch áº£nh bÃ¬nh thÆ°á»ng</li>
</ul>
<p>ğŸ”¹<strong>100% an toÃ n cho website</strong></p>
<p>WordPress â†’ CloudFront â†’ S3 (Glacier IR) â†’ tráº£ láº¡i áº£nh â†’ KhÃ´ng cÃ³ downtime hÃ¬nh áº£nh.</p>
<p>ğŸ”¹<strong>GiÃ¡ lÆ°u trá»¯ ráº¥t ráº»</strong></p>
<ul>
<li>Tháº¥p hÆ¡n cáº£ Standard-IA</li>
<li>Retrieval cost cao hÆ¡n má»™t chÃºt, nhÆ°ng CloudFront cache hit 95%+ â†’ khÃ´ng Ä‘Ã¡ng ká»ƒ.</li>
</ul>
<p>Náº¿u báº¡n chá»‰ dÃ¹ng Glacier IR cho áº£nh cÅ© > 365 ngÃ y, thÃ¬ Ä‘Ã¢y lÃ  chiáº¿n lÆ°á»£c ráº¥t há»£p lÃ½.</p>
<h4 id="trÃ¡nh-nháº§m-vá»›i-glacier-khÃ´ng-instant-flexible--deep-archive">TrÃ¡nh nháº§m vá»›i Glacier khÃ´ng Instant (Flexible / Deep Archive)</h4>









































<table><thead><tr><th>Storage Class</th><th>Truy cáº­p</th><th>Delay</th><th>áº¢nh website hiá»ƒn thá»‹?</th></tr></thead><tbody><tr><td><strong>Standard</strong></td><td>Ráº¥t nhanh</td><td>0s</td><td>âœ” OK</td></tr><tr><td><strong>Standard-IA</strong></td><td>Nhanh</td><td>0s</td><td>âœ” OK</td></tr><tr><td><strong>Glacier Instant Retrieval</strong></td><td>Nhanh</td><td>&#x3C;1s</td><td>âœ” OK</td></tr><tr><td><strong>Glacier Flexible Retrieval</strong></td><td>Cháº­m</td><td><strong>Minutes â€“ hours</strong></td><td>âŒ KHÃ”NG dÃ¹ng cho CDN áº£nh</td></tr><tr><td><strong>Glacier Deep Archive</strong></td><td>Ráº¥t cháº­m</td><td><strong>12â€“48 hours</strong></td><td>âŒ Tuyá»‡t Ä‘á»‘i cáº¥m dÃ¹ng cho website</td></tr></tbody></table>
<p><strong>Chá»‰ dÃ¹ng Glacier Instant Retrieval, khÃ´ng dÃ¹ng Glacier Flexible/Deep Archive</strong>.</p>
<h3 id="44-hÆ°á»›ng-dáº«n-chi-tiáº¿t-táº¡o-lifecycle-rule"><strong>4.4. HÆ°á»›ng dáº«n chi tiáº¿t táº¡o Lifecycle Rule</strong></h3>
<p><strong>ğŸ”¹ STEP 1 â€“ VÃ o bucket S3</strong></p>
<p><code>S3</code> â†’ <code>your bucket</code> â†’ <code>Management</code> â†’ <code>Lifecycle Rules</code> â†’ <code>Create rule</code></p>
<p><strong>ğŸ”¹ STEP 2 â€“ Äáº·t tÃªn rule</strong></p>
<p>VD: <code>lifecycle-images-2023</code></p>
<p><strong>ğŸ”¹ STEP 3 â€“ Chá»n pháº¡m vi (Filter)</strong></p>
<p>Chá»n <strong>Prefix</strong> vÃ  nháº­p: <code>wp-content/uploads/2023/</code></p>
<p>Giáº£i thÃ­ch:</p>
<ul>
<li>Chá»‰ áº£nh nÄƒm 2023 bá»‹ Ã¡p dá»¥ng rule nÃ y.</li>
<li>áº¢nh 2024â€“2025 khÃ´ng bá»‹ Ä‘á»¥ng tá»›i.</li>
<li>JS/CSS/asset khÃ¡c náº¿u báº¡n Ä‘á»ƒ chá»— khÃ¡c â†’ khÃ´ng bá»‹ áº£nh hÆ°á»Ÿng.</li>
</ul>
<p><strong>ğŸ”¹ STEP 4 â€“ Báº­t Transition Rule</strong></p>
<p>Check: <code>Transition current versions of objects between storage classes</code></p>
<p>ThÃªm 2 transition:</p>
<p><strong>Transition 1:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>After 90 days â†’ Move to: Standard-IA</span></span></code></pre>
<p><strong>Transition 2:</strong></p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>After 365 days â†’ Move to: Glacier Instant Retrieval</span></span></code></pre>
<p><strong>LÆ°u Ã½:</strong></p>
<ul>
<li>KHÃ”NG chá»n Glacier Flexible Retrieval</li>
<li>KHÃ”NG chá»n Deep Archive</li>
<li>Chá»‰ chá»n: Glacier Instant Retrieval (GIR)</li>
</ul>
<p><strong>ğŸ”¹ STEP 5 â€“ KHÃ”NG báº­t Expiration</strong></p>
<p>Tuyá»‡t Ä‘á»‘i khÃ´ng báº­t:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>Expire current versions of objects</span></span></code></pre>
<p>Äiá»u nÃ y sáº½ xÃ³a áº£nh â†’ website máº¥t áº£nh.</p>
<p><strong>ğŸ”¹ STEP 6 â€“ Noncurrent Version Expiration</strong></p>
<p>KHÃ”NG báº­t <strong>Noncurrent Version Expiration</strong> (náº¿u báº¡n báº­t <strong>Versioning</strong>). Chá»‰ báº­t náº¿u báº¡n muá»‘n xÃ³a version cÅ© â†’ khÃ´ng cáº§n cho WooCommerce.</p>
<p>Sau khi táº¡o rule 2023, báº¡n cÃ³ thá»ƒ clone vÃ  táº¡o rule cho 2022, 2021â€¦ tÃ¹y nhu cáº§u.</p>
<p><strong>Khi báº¡n push cáº£ JS/CSS/ASSETS lÃªn S3</strong></p>
<blockquote>
<p>Náº¿u tÆ°Æ¡ng láº¡i tÃ´i submit cáº£ js, css, assets file lÃªn S3 Storage thÃ¬ Lifecycle rule nÃ y cÃ³ áº£nh hÆ°á»Ÿng khÃ´ng?</p>
</blockquote>
<p>CÃ¢u tráº£ lá»i: KhÃ´ng áº£nh hÆ°á»Ÿng Báº¤T Ká»² thá»© gÃ¬, náº¿u báº¡n lÃ m Ä‘Ãºng nhÆ° mÃ¬nh hÆ°á»›ng dáº«n (dÃ¹ng prefix theo nÄƒm).</p>
<p>VÃ¬ Lifecycle dÃ¹ng Filter prefix, vÃ­ dá»¥: <code>wp-content/uploads/2023/</code> â†’ S3 chá»‰ cháº¡y rule cho cÃ¡c object báº¯t Ä‘áº§u báº±ng prefix Ä‘Ã³.</p>
<p>Náº¿u sau nÃ y báº¡n upload JS/CSS vÃ o:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>assets/js/</span></span>
<span class="line"><span>assets/css/</span></span>
<span class="line"><span>cdn/js/</span></span>
<span class="line"><span>static/</span></span></code></pre>
<p>â‡’ KHÃ”NG liÃªn quan Ä‘áº¿n <code>wp-content/uploads/2023/</code>.</p>
<p><strong>LÆ°u Ã½ quan trá»ng náº¿u tÆ°Æ¡ng lai báº¡n upload JS/CSS vÃ o wp-content</strong></p>
<p>Náº¿u báº¡n upload JS/CSS vÃ o:</p>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>wp-content/uploads/assets/</span></span>
<span class="line"><span>wp-content/uploads/somefolder/</span></span></code></pre>
<p>â†’ NÃ³ Náº°M TRONG prefix <code>wp-content/uploads/2023/</code> â†’ S3 váº«n chuyá»ƒn sang IA/GIR theo lifecycle.</p>
<p><strong>CÃ¡ch xá»­ lÃ½:</strong></p>
<ul>
<li>LuÃ´n Ä‘á»ƒ assets JS/CSS táº¡i thÆ° má»¥c riÃªng ngoÃ i <code>uploads</code>:
VÃ­ dá»¥:</li>
</ul>
<pre class="astro-code github-dark" style="background-color:#24292e;color:#e1e4e8; overflow-x: auto;" tabindex="0" data-language="plain"><code><span class="line"><span>wp-content/themes/yourtheme/assets/</span></span>
<span class="line"><span>cdn/js/</span></span>
<span class="line"><span>cdn/css/</span></span></code></pre>
<ul>
<li>KHÃ”NG Ä‘Æ°a assets vÃ o uploads náº¿u báº¡n dÃ¹ng Lifecycle cho uploads.</li>
<li>LuÃ´n upload áº£nh JPG <code>1200â€“1500px</code> â†’ LSCWP convert thÃ nh WebP</li>
<li>DÃ¹ng tÃªn file SEO-friendly: <code>product-name-keyword-color.jpg</code></li>
<li>Alt text tá»± Ä‘á»™ng theo tÃªn sáº£n pháº©m</li>
<li>XÃ³a áº£nh thá»«a / áº£nh khÃ´ng dÃ¹ng báº±ng <code>Media Cleaner</code></li>
</ul>
<h2 id="káº¿t-luáº­n"><strong>Káº¾T LUáº¬N</strong></h2>
<p><strong>Vá»›i full bá»™ cáº¥u hÃ¬nh tá»«:</strong></p>
<ul>
<li>Cloudflare (WAF + Cache Rules + AntiBot)</li>
<li>OpenLiteSpeed (PHP 8.2 + QUIC + OPcache)</li>
<li>LSCache (page cache, object cache, WebP)</li>
<li>MariaDB tuning</li>
<li>AWS S3 + CloudFront (CDN áº£nh chuáº©n tá»‘i Æ°u)</li>
</ul>
<p><strong>Báº¡n sáº½ cÃ³:</strong></p>
<ul>
<li>ğŸš€ Website siÃªu nhanh (&#x3C;1.5â€“2s US/UK)</li>
<li>ğŸ” Chá»‘ng bot, chá»‘ng DDOS, chá»‘ng scan cá»±c tá»‘t</li>
<li>ğŸ’¾ Giáº£m 80â€“90% táº£i vÃ o VPS</li>
<li>ğŸ’¸ BÄƒng thÃ´ng S3/CloudFront giáº£m Ä‘Ã¡ng ká»ƒ</li>
<li>ğŸ“ˆ Äiá»ƒm SEO &#x26; Core Web Vitals ráº¥t cao</li>
</ul>   <p class="text-slate">Tráº£i nghiá»‡m tá»‘t nháº¥t tá»« thá»±c hÃ nh â€” Anh Nguyen</p> <a href="/blog/" title="Danh sÃ¡ch bÃ i viáº¿t">&larr; Danh sÃ¡ch bÃ i viáº¿t</a> </article> </main> <div class="px-10 py-6"> <div id="disqus_thread"></div> <script type="module">(function(){var t=document,e=t.createElement("script");e.src="https://anmitom.disqus.com/embed.js",e.setAttribute("data-timestamp",+new Date),(t.head||t.body).appendChild(e)})();</script> <noscript>Enable JavaScript to view comments powered by Disqus.</noscript> </div> <section class="p-6"> <section class="mt-8"> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: #2dd4bf;">  <div class="flex justify-between items-start"> <h2 class="text-2xl md:text-4xl lg:text-6xl mb-8 dm-serif">
CÃ³ gÃ¬ má»›i?
</h2> <div class="hidden md:block"> <a href="/blog/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #a78bfa;"> Xem táº¥t cáº£ &rarr; </a> </div> <div class="block md:hidden"> <a href="/blog/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #34d399;"> Xem táº¥t cáº£ </a> </div> </div> <ul class="grid md:grid-cols-2 lg:grid-cols-3 gap-8"> <li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">Triá»ƒn khai Blog Astro + CI/CD Äa Ná»n Táº£ng</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/Deploy code with the Astro GitHub integration.webp?v=33-a7ecadd" alt="Triá»ƒn khai Blog Astro + CI/CD Äa Ná»n Táº£ng" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">BÃ i viáº¿t mÃ¬nh tá»•ng há»£p toÃ n bá»™ quÃ¡ trÃ¬nh triá»ƒn khai blog cÃ¡ nhÃ¢n vá»›i Astro (sá»­ dá»¥ng Sveltia CMS), multi deploy, CI/CD GitHub Actions, cache busting, multi host (GitHub Pages + Vercel + Render + Netlify + DO + Cloudflare + Neocities + Surge + Wasmer)â€¦ tá»« A â†’ Z.</p>  <div class="flex justify-end my-4"> <a href="/blog/trien-khai-blog-astro-ci-cd-da-nen-tang/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #38bdf8;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/blog/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #f472b6;"> Blog </span> </a> </li><li> <a class="sanchez" href="/blog/tags/github/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #2dd4bf;"> GitHub </span> </a> </li><li> <a class="sanchez" href="/blog/tags/láº­p trÃ¬nh/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #fb923c;"> Láº­p TrÃ¬nh </span> </a> </li> </ul>  </div> </div>   </div> </li><li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">Tá»‘i Æ°u &amp; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &amp; AWS S3 + CloudFront</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/How to Set Up a WordPress Website with SSL Using Amazon S3 Cloudflare.webp?v=33-a7ecadd" alt="Tá»‘i Æ°u &#38; báº£o máº­t website dÃ¹ng Cloudflare, VPS OpenLiteSpeed &#38; AWS S3 + CloudFront" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">Website thÆ°Æ¡ng máº¡i Ä‘iá»‡n tá»­ (WooCommerce) cáº§n vá»«a nhanh â€“ á»•n Ä‘á»‹nh â€“ báº£o máº­t, láº¡i pháº£i tiáº¿t kiá»‡m chi phÃ­ bÄƒng thÃ´ng vÃ  tÃ i nguyÃªn VPS. BÃ i viáº¿t nÃ y tá»•ng há»£p toÃ n bá»™ cÃ¡c bÆ°á»›c cáº¥u hÃ¬nh mÃ  tÃ´i Ä‘Ã£ triá»ƒn khai thá»±c táº¿: Cloudflare Free, VPS 2 CPU â€“ 8GB RAM cháº¡y OpenLiteSpeed + PHP 8.2, WordPress + WooCommerce, AWS S3 + CloudFront lÃ m CDN áº£nh.</p>  <div class="flex justify-end my-4"> <a href="/blog/toi-uu-bao-mat-toan-dien-cho-website-woocommerce-dung-cloudflare-vps-openlitespeed-aws-s3-cloudfront/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #a78bfa;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/aws services/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #a3e635;"> AWS Services </span> </a> </li><li> <a class="sanchez" href="/blog/tags/wordpress/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #60a5fa;"> Wordpress </span> </a> </li><li> <a class="sanchez" href="/blog/tags/cloudflare/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #fb7185;"> Cloudflare </span> </a> </li> </ul>  </div> </div>   </div> </li><li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">TÃ¡i sinh HDD/SSD Box dÃ¹ng Ventoy táº¡o bootable USB drive cho ISO/WIM/IMG/VHD(x)/EFI files</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/How to Set HDD SSD as Boot Drive in Windows Ubuntu.webp?v=33-a7ecadd" alt="TÃ¡i sinh HDD/SSD Box dÃ¹ng Ventoy táº¡o bootable USB drive cho ISO/WIM/IMG/VHD(x)/EFI files" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">Náº¿u á»• cá»©ng HDD/SSD cá»§a báº¡n Ä‘Ã£ lÃ¢u ngÃ y vÃ  cÃ³ dáº¥u hiá»‡u cháº­m, bad sector, hoáº·c lá»—i ghi, viá»‡c lÃ m sáº¡ch hoÃ n toÃ n (low level format hoáº·c hard reset) lÃ  bÆ°á»›c chuáº©n nháº¥t trÆ°á»›c khi chia láº¡i phÃ¢n vÃ¹ng cho má»¥c Ä‘Ã­ch cá»©u há»™. DÆ°á»›i Ä‘Ã¢y lÃ  hÆ°á»›ng dáº«n chi tiáº¿t vÃ  cÃ¡ch lÃ m an toÃ n Ä‘á»ƒ tÃ¡i sinh á»• HDD/SSD cÅ© táº¡o bootable má»¥c Ä‘Ã­ch cá»©u há»™ vá»›i Ventoy Tool.</p>  <div class="flex justify-end my-4"> <a href="/blog/tai-sinh-hdd-ssd-box-dung-ventoy-tao-bootable-usb-drive-cho-iso-wim-img-vhd-x-efi-files/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #2dd4bf;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/há»‡ thá»‘ng/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #2dd4bf;"> Há»‡ Thá»‘ng </span> </a> </li><li> <a class="sanchez" href="/blog/tags/usb bootable/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #fb7185;"> USB Bootable </span> </a> </li> </ul>  </div> </div>   </div> </li><li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">So SÃ¡nh toÃ n diá»‡n LocalWP, MAMP, Laragon, XAMPP vÃ  WAMP Server TrÃªn Windows</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/Install PHP on Windows and Setup a local web server.webp?v=33-a7ecadd" alt="So SÃ¡nh toÃ n diá»‡n LocalWP, MAMP, Laragon, XAMPP vÃ  WAMP Server TrÃªn Windows" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">Báº¡n Ä‘ang tÃ¬m mÃ´i trÆ°á»ng local Ä‘á»ƒ phÃ¡t triá»ƒn PHP hoáº·c WordPress trÃªn Windows? BÃ i viáº¿t nÃ y sáº½ giÃºp báº¡n hiá»ƒu rÃµ sá»± khÃ¡c biá»‡t giá»¯a LocalWP, Laragon, MAMP, XAMPP, vÃ  WAMP Server â€“ Ä‘á»ƒ chá»n ra cÃ´ng cá»¥ tá»‘i Æ°u nháº¥t cho quy trÃ¬nh lÃ m viá»‡c cá»§a báº¡n.</p>  <div class="flex justify-end my-4"> <a href="/blog/so-sanh-toan-dien-localwp-mamp-laragon-xampp-va-wamp-server-tren-windows/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #facc15;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/php/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #fb7185;"> PHP </span> </a> </li><li> <a class="sanchez" href="/blog/tags/webserver/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #a78bfa;"> Webserver </span> </a> </li><li> <a class="sanchez" href="/blog/tags/láº­p trÃ¬nh/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #2dd4bf;"> Láº­p TrÃ¬nh </span> </a> </li> </ul>  </div> </div>   </div> </li><li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">Script Backup Website siÃªu nháº¹: GPG + SHA256 + Telegram Upload + Auto Cleanup 7 ngÃ y</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/send 2gb file in telegram.webp?v=33-a7ecadd" alt="Script Backup Website siÃªu nháº¹: GPG + SHA256 + Telegram Upload + Auto Cleanup 7 ngÃ y" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">CÃ³ thá»ƒ dÃ¹ng Telegram lÃ m backup táº¡m thá»i hoáº·c phá»¥ trá»£, nhÆ°ng khÃ´ng nÃªn xem nÃ³ nhÆ° má»™t giáº£i phÃ¡p backup chÃ­nh hay lÃ¢u dÃ i. Dung lÆ°á»£ng miá»…n phÃ­ lá»›n (gá»­i bao nhiÃªu file cÅ©ng Ä‘Æ°á»£c, miá»…n &lt;2GB hoáº·c &lt;4GB náº¿u cÃ³ Premium). NhÆ°ng Telegram cÃ³ thá»ƒ thay Ä‘á»•i chÃ­nh sÃ¡ch báº¥t ká»³ lÃºc nÃ o.</p>  <div class="flex justify-end my-4"> <a href="/blog/script-backup-website-sieu-nhe-gpg-sha256-telegram-upload-auto-cleanup-7-ngay/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #e879f9;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/há»‡ thá»‘ng/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #f472b6;"> Há»‡ Thá»‘ng </span> </a> </li><li> <a class="sanchez" href="/blog/tags/backup sites/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #c084fc;"> Backup Sites </span> </a> </li> </ul>  </div> </div>   </div> </li><li> <div class="brutal-card" data-astro-cid-hnv2b5w7 style="--color: white;">  <h3 class="poppins text-lg md:text-xl">RClone biáº¿n Google Drive thÃ nh á»• Ä‘Ä©a ná»™i bá»™ trÃªn Windows Explorer vá»›i UI mÆ°á»£t, tá»‘c Ä‘á»™ max</h3> <div class="rounded-lg border-3 border-black my-4 h-56"> <img src="/uploads/Rclone Tutorial Install on Windows and Connect.webp?v=33-a7ecadd" alt="RClone biáº¿n Google Drive thÃ nh á»• Ä‘Ä©a ná»™i bá»™ trÃªn Windows Explorer vá»›i UI mÆ°á»£t, tá»‘c Ä‘á»™ max" loading="lazy" decoding="async" fetchpriority="auto" width="800" height="400" class="rounded h-full w-full object-cover"> </div> <p class="poppins">KhÃ¡m phÃ¡ cÃ¡ch tÃ­ch há»£p rclone vá»›i Google Drive trÃªn Windows Ä‘á»ƒ tÄƒng tá»‘c workflow: mount thÃ nh á»• X:, backup tá»± Ä‘á»™ng vÃ  quáº£n lÃ½ file ngay trong Explorer. HÆ°á»›ng dáº«n cháº¡y OAuth qua trÃ¬nh duyá»‡t, sau Ä‘Ã³ láº¥y file rclone.conf Ä‘á»ƒ sá»­ dá»¥ng cho má»i VPS/hosting khÃ¡c mÃ  khÃ´ng cáº§n xÃ¡c thá»±c giao diá»‡n web ná»¯a.</p>  <div class="flex justify-end my-4"> <a href="/blog/rclone-bien-google-drive-thanh-o-dia-noi-bo-tren-windows-explorer-voi-ui-muot-toc-do-max/" class="brutal-btn" data-astro-cid-p7xutspj style="--color: #2dd4bf;"> Xem chi tiáº¿t &rarr; </a> </div> <div class="hidden sm:inline-block"> <p class="poppins mt-2">CÃ¹ng chá»§ Ä‘á»:</p> <div class="flex justify-between items-center"> <ul class="flex flex-wrap gap-4 mt-2"> <li> <a class="sanchez" href="/blog/tags/rclone/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #2dd4bf;"> rclone </span> </a> </li><li> <a class="sanchez" href="/blog/tags/google drive/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #fb7185;"> Google Drive </span> </a> </li><li> <a class="sanchez" href="/blog/tags/há»‡ thá»‘ng/"> <span class="brutal-pill" data-astro-cid-4z4ikc6r style="--color: #4ade80;"> Há»‡ Thá»‘ng </span> </a> </li> </ul>  </div> </div>   </div> </li> </ul>  </div> </section> </section>  <footer class="bg-black text-white p-6" data-astro-cid-4jhxmvk6> <h2 class="hidden" data-astro-cid-4jhxmvk6>Footer</h2> <p class="outfit" data-astro-cid-4jhxmvk6>
KÃ½ sá»± MITOM â€” viáº¿t bá»Ÿi <a href="https://www.anhnnp.github.io/" target="_blank" class="text-blue" data-astro-cid-4jhxmvk6>ANH NGUYEN</a>, dÃ nh cho nhá»¯ng ai thÃ­ch lÃ m, thá»­ vÃ  nghÄ© khÃ¡c.
</p> </footer>  <script type="module">document.addEventListener("astro:page-load",()=>{const o=document.querySelector(".backToTop"),e=()=>{window.scrollY>250?o?.classList.add("active"):o?.classList.remove("active")};o?.addEventListener("click",()=>{window.scrollTo({top:0,behavior:"smooth"})}),window.addEventListener("scroll",e)});</script> </body></html>